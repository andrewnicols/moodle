function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}(function(global,factory){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=factory(require("video.js")):"function"==typeof define&&define.amd?define ("media_videojs/videojs-flash-lazy",["media_videojs/video-lazy"],factory):global.videojsFlash=factory(global.videojs)})(this,function(videojs){"use strict";videojs=videojs&&videojs.hasOwnProperty("default")?videojs["default"]:videojs;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},win;if("undefined"!=typeof window){win=window}else if("undefined"!=typeof commonjsGlobal){win=commonjsGlobal}else if("undefined"!=typeof self){win=self}else{win={}}var window_1=win,classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}},inherits=function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass){throw new TypeError("Super expression must either be null or a function, not "+_typeof(superClass))}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass},possibleConstructorReturn=function(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&("object"===_typeof(call)||"function"==typeof call)?call:self},Tech=videojs.getComponent("Tech"),Dom=videojs.dom,Url=videojs.url,createTimeRange=videojs.createTimeRange,mergeOptions=videojs.mergeOptions,navigator=window_1&&window_1.navigator||{},Flash=function(_Tech){inherits(Flash,_Tech);function Flash(options,ready){classCallCheck(this,Flash);var _this=possibleConstructorReturn(this,_Tech.call(this,options,ready));if(options.source){_this.ready(function(){this.setSource(options.source)},!0)}if(options.startTime){_this.ready(function(){this.load();this.play();this.currentTime(options.startTime)},!0)}window_1.videojs=window_1.videojs||{};window_1.videojs.Flash=window_1.videojs.Flash||{};window_1.videojs.Flash.onReady=Flash.onReady;window_1.videojs.Flash.onEvent=Flash.onEvent;window_1.videojs.Flash.onError=Flash.onError;_this.on("seeked",function(){this.lastSeekTarget_=void 0});return _this}Flash.prototype.createEl=function(){var options=this.options_;if(!options.swf){options.swf="https://vjs.zencdn.net/swf/5.4.2/video-js.swf"}var objId=options.techId,flashVars=mergeOptions({readyFunction:"videojs.Flash.onReady",eventProxyFunction:"videojs.Flash.onEvent",errorEventProxyFunction:"videojs.Flash.onError",autoplay:options.autoplay,preload:options.preload,loop:options.loop,muted:options.muted},options.flashVars),params=mergeOptions({wmode:"opaque",bgcolor:"#000000"},options.params),attributes=mergeOptions({id:objId,name:objId,class:"vjs-tech"},options.attributes);this.el_=Flash.embed(options.swf,flashVars,params,attributes);this.el_.tech=this;return this.el_};Flash.prototype.play=function(){if(this.ended()){this.setCurrentTime(0)}this.el_.vjs_play()};Flash.prototype.pause=function(){this.el_.vjs_pause()};Flash.prototype.src=function(_src){if(_src===void 0){return this.currentSrc()}return this.setSrc(_src)};Flash.prototype.setSrc=function(src){var _this2=this;src=Url.getAbsoluteURL(src);this.el_.vjs_src(src);if(this.autoplay()){this.setTimeout(function(){return _this2.play()},0)}};Flash.prototype.seeking=function(){return this.lastSeekTarget_!==void 0};Flash.prototype.setCurrentTime=function(time){var seekable=this.seekable();if(seekable.length){time=time>seekable.start(0)?time:seekable.start(0);time=time<seekable.end(seekable.length-1)?time:seekable.end(seekable.length-1);this.lastSeekTarget_=time;this.trigger("seeking");this.el_.vjs_setProperty("currentTime",time);_Tech.prototype.setCurrentTime.call(this)}};Flash.prototype.currentTime=function(){if(this.seeking()){return this.lastSeekTarget_||0}return this.el_.vjs_getProperty("currentTime")};Flash.prototype.currentSrc=function(){if(this.currentSource_){return this.currentSource_.src}return this.el_.vjs_getProperty("currentSrc")};Flash.prototype.duration=function duration(){if(0===this.readyState()){return NaN}var duration=this.el_.vjs_getProperty("duration");return 0<=duration?duration:1/0};Flash.prototype.load=function(){this.el_.vjs_load()};Flash.prototype.poster=function(){this.el_.vjs_getProperty("poster")};Flash.prototype.setPoster=function(){};Flash.prototype.seekable=function(){var duration=this.duration();if(0===duration){return createTimeRange()}return createTimeRange(0,duration)};Flash.prototype.buffered=function(){var ranges=this.el_.vjs_getProperty("buffered");if(0===ranges.length){return createTimeRange()}return createTimeRange(ranges[0][0],ranges[0][1])};Flash.prototype.supportsFullScreen=function(){return!1};Flash.prototype.enterFullScreen=function(){return!1};Flash.prototype.getVideoPlaybackQuality=function(){var videoPlaybackQuality=this.el_.vjs_getProperty("getVideoPlaybackQuality");if(window_1.performance&&"function"==typeof window_1.performance.now){videoPlaybackQuality.creationTime=window_1.performance.now()}else if(window_1.performance&&window_1.performance.timing&&"number"==typeof window_1.performance.timing.navigationStart){videoPlaybackQuality.creationTime=window_1.Date.now()-window_1.performance.timing.navigationStart}return videoPlaybackQuality};return Flash}(Tech),_readWrite=["rtmpConnection","rtmpStream","preload","defaultPlaybackRate","playbackRate","autoplay","loop","controls","volume","muted","defaultMuted"],_readOnly=["networkState","readyState","initialTime","startOffsetTime","paused","ended","videoWidth","videoHeight"],_api=Flash.prototype;function _createSetter(attr){var attrUpper=attr.charAt(0).toUpperCase()+attr.slice(1);_api["set"+attrUpper]=function(val){return this.el_.vjs_setProperty(attr,val)}}function _createGetter(attr){_api[attr]=function(){return this.el_.vjs_getProperty(attr)}}for(var i=0;i<_readWrite.length;i++){_createGetter(_readWrite[i]);_createSetter(_readWrite[i])}for(var _i=0;_i<_readOnly.length;_i++){_createGetter(_readOnly[_i])}Flash.isSupported=function(){if(videojs.browser.IS_CHROME&&(!videojs.browser.IS_ANDROID||!videojs.browser.IS_IOS)||videojs.browser.IS_SAFARI&&!videojs.browser.IS_IOS||videojs.browser.IS_EDGE){return!0}return 10<=Flash.version()[0]};Tech.withSourceHandlers(Flash);Flash.nativeSourceHandler={};Flash.nativeSourceHandler.canPlayType=function(type){if(type in Flash.formats){return"maybe"}return""};Flash.nativeSourceHandler.canHandleSource=function(source){var type;function guessMimeType(src){var ext=Url.getFileExtension(src);if(ext){return"video/"+ext}return""}if(!source.type){type=guessMimeType(source.src)}else{type=source.type.replace(/;.*/,"").toLowerCase()}return Flash.nativeSourceHandler.canPlayType(type)};Flash.nativeSourceHandler.handleSource=function(source,tech){tech.setSrc(source.src)};Flash.nativeSourceHandler.dispose=function(){};Flash.registerSourceHandler(Flash.nativeSourceHandler);Flash.formats={"video/flv":"FLV","video/x-flv":"FLV","video/mp4":"MP4","video/m4v":"MP4"};Flash.onReady=function(currSwf){var el=Dom.$("#"+currSwf),tech=el&&el.tech;if(tech&&tech.el()){Flash.checkReady(tech)}};Flash.checkReady=function(tech){if(!tech.el()){return}if(tech.el().vjs_getProperty){tech.triggerReady()}else{this.setTimeout(function(){Flash.checkReady(tech)},50)}};Flash.onEvent=function(swfID,eventName){var tech=Dom.$("#"+swfID).tech,args=Array.prototype.slice.call(arguments,2);tech.setTimeout(function(){tech.trigger(eventName,args)},1)};Flash.onError=function(swfID,err){var tech=Dom.$("#"+swfID).tech;if("srcnotfound"===err){return tech.error(4)}if("string"==typeof err){tech.error("FLASH: "+err)}else{err.origin="flash";tech.error(err)}};Flash.version=function(){var version$$1="0,0,0";try{version$$1=new window_1.ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(e){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){version$$1=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(err){}}return version$$1.split(",")};Flash.embed=function(swf,flashVars,params,attributes){var code=Flash.getEmbedCode(swf,flashVars,params,attributes),obj=Dom.createEl("div",{innerHTML:code}).childNodes[0];return obj};Flash.getEmbedCode=function(swf,flashVars,params,attributes){var flashVarsString="",paramsString="",attrsString="";if(flashVars){Object.getOwnPropertyNames(flashVars).forEach(function(key){flashVarsString+=key+"="+flashVars[key]+"&amp;"})}params=mergeOptions({movie:swf,flashvars:flashVarsString,allowScriptAccess:"always",allowNetworking:"all"},params);Object.getOwnPropertyNames(params).forEach(function(key){paramsString+="<param name=\""+key+"\" value=\""+params[key]+"\" />"});attributes=mergeOptions({data:swf,width:"100%",height:"100%"},attributes);Object.getOwnPropertyNames(attributes).forEach(function(key){attrsString+=key+"=\""+attributes[key]+"\" "});return"<object type=\"application/x-shockwave-flash\" "+attrsString+">"+paramsString+"</object>"};(function(Flash){Flash.streamingFormats={"rtmp/mp4":"MP4","rtmp/flv":"FLV"};Flash.streamFromParts=function(connection,stream){return connection+"&"+stream};Flash.streamToParts=function(src){var parts={connection:"",stream:""};if(!src){return parts}var connEnd=src.search(/&(?![\w-]+=)/),streamBegin=void 0;if(-1!==connEnd){streamBegin=connEnd+1}else{connEnd=streamBegin=src.lastIndexOf("/")+1;if(0===connEnd){connEnd=streamBegin=src.length}}parts.connection=src.substring(0,connEnd);parts.stream=src.substring(streamBegin,src.length);return parts};Flash.isStreamingType=function(srcType){return srcType in Flash.streamingFormats};Flash.RTMP_RE=/^rtmp[set]?:\/\//i;Flash.isStreamingSrc=function(src){return Flash.RTMP_RE.test(src)};Flash.rtmpSourceHandler={};Flash.rtmpSourceHandler.canPlayType=function(type){if(Flash.isStreamingType(type)){return"maybe"}return""};Flash.rtmpSourceHandler.canHandleSource=function(source){var can=Flash.rtmpSourceHandler.canPlayType(source.type);if(can){return can}if(Flash.isStreamingSrc(source.src)){return"maybe"}return""};Flash.rtmpSourceHandler.handleSource=function(source,tech){var srcParts=Flash.streamToParts(source.src);tech.setRtmpConnection(srcParts.connection);tech.setRtmpStream(srcParts.stream)};Flash.registerSourceHandler(Flash.rtmpSourceHandler);return Flash})(Flash);if(Tech.getTech("Flash")){videojs.log.warn("Not using videojs-flash as it appears to already be registered");videojs.log.warn("videojs-flash should only be used with video.js@6 and above")}else{videojs.registerTech("Flash",Flash)}Flash.VERSION="2.2.1";return Flash});
//# sourceMappingURL=videojs-flash-lazy.min.js.map
