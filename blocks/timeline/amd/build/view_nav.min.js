define ("block_timeline/view_nav",["jquery","core/custom_interaction_events","block_timeline/view","core/ajax","core/notification","core/utils"],function($,CustomEvents,View,Ajax,Notification,Utils){var SELECTORS={TIMELINE_DAY_FILTER:"[data-region=\"day-filter\"]",TIMELINE_DAY_FILTER_OPTION:"[data-from]",TIMELINE_VIEW_SELECTOR:"[data-region=\"view-selector\"]",DATA_DAYS_OFFSET:"[data-days-offset]",DATA_DAYS_LIMIT:"[data-days-limit]",TIMELINE_SEARCH_INPUT:"[data-action=\"search\"]",TIMELINE_SEARCH_CLEAR_ICON:"[data-action=\"clearsearch\"]",NO_COURSES_EMPTY_MESSAGE:"[data-region=\"no-courses-empty-message\"]"},updateUserPreferences=function(type,value){Ajax.call([{methodname:"core_user_update_user_preferences",args:{preferences:[{type:type,value:value}]}}])[0].fail(Notification.exception)},registerTimelineDaySelector=function(root,timelineViewRoot){var timelineDaySelectorContainer=root.find(SELECTORS.TIMELINE_DAY_FILTER);CustomEvents.define(timelineDaySelectorContainer,[CustomEvents.events.activate]);timelineDaySelectorContainer.on(CustomEvents.events.activate,SELECTORS.TIMELINE_DAY_FILTER_OPTION,function(e,data){var filtername=$(e.currentTarget).data("filtername");updateUserPreferences("block_timeline_user_filter_preference",filtername);var option=$(e.target).closest(SELECTORS.TIMELINE_DAY_FILTER_OPTION);if("true"==option.attr("aria-current")){return}var daysOffset=option.attr("data-from"),daysLimit=option.attr("data-to"),elementsWithDaysOffset=root.find(SELECTORS.DATA_DAYS_OFFSET);elementsWithDaysOffset.attr("data-days-offset",daysOffset);if(daysLimit!=void 0){elementsWithDaysOffset.attr("data-days-limit",daysLimit)}else{elementsWithDaysOffset.removeAttr("data-days-limit")}View.reset(timelineViewRoot);data.originalEvent.preventDefault()})},registerViewSelector=function(root,timelineViewRoot){var viewSelector=root.find(SELECTORS.TIMELINE_VIEW_SELECTOR);viewSelector.on("shown shown.bs.tab",function(e){View.shown(timelineViewRoot);$(e.target).removeClass("active")});CustomEvents.define(viewSelector,[CustomEvents.events.activate]);viewSelector.on(CustomEvents.events.activate,"[data-toggle='tab']",function(e){var filtername=$(e.currentTarget).data("filtername");updateUserPreferences("block_timeline_user_sort_preference",filtername)})},registerSearch=function(root,timelineViewRoot){var searchInput=root.find(SELECTORS.TIMELINE_SEARCH_INPUT),clearSearchIcon=root.find(SELECTORS.TIMELINE_SEARCH_CLEAR_ICON);searchInput.on("input",Utils.debounce(function(){if(""!==searchInput.val()){activeSearchState(clearSearchIcon,timelineViewRoot)}else{clearSearchState(clearSearchIcon,timelineViewRoot)}},300));clearSearchIcon.on("click",function(){searchInput.val("");clearSearchState(clearSearchIcon,timelineViewRoot);searchInput.focus()})},activeSearchState=function(clearSearchIcon,timelineViewRoot){clearSearchIcon.removeClass("d-none");View.reset(timelineViewRoot)},clearSearchState=function(clearSearchIcon,timelineViewRoot){clearSearchIcon.addClass("d-none");View.reset(timelineViewRoot)};return{init:function init(root,timelineViewRoot){root=$(root);registerViewSelector(root,timelineViewRoot);if(!root.find(SELECTORS.NO_COURSES_EMPTY_MESSAGE).length){registerTimelineDaySelector(root,timelineViewRoot);registerSearch(root,timelineViewRoot)}}}});
//# sourceMappingURL=view_nav.min.js.map
