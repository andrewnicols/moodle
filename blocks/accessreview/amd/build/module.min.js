function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var h=a.apply(b,c);function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}f(void 0)})}}define ("block_accessreview/module",["jquery","core/str","core/ajax","core/templates"],function(a,b,c,d){var i,j,k,l=0,m=!0,n="",o="",p,q={},r=function(){return b.get_strings([{key:"passed",component:"tool_brickfield"},{key:"failed",component:"tool_brickfield"},{key:"errors",component:"block_accessreview"},{key:"percenterrors",component:"block_accessreview"},{key:"success"}]).then(function(a){q.passed=a[0];q.failed=a[1];q.errors=a[2];q.percenterrors=a[3];q.success=a[4]})};function e(a,b,c){var d=parseInt((b-k)/l*2),e="block_accessreview_success";if(1>d){e="block_accessreview_warning"}if(1<=d){e="block_accessreview_danger"}if(0==b){e="block_accessreview_success"}if(a){if("showicons"!=p){if(1<=a.className.search("label")){e+="_label"}a.className+=" alert "+e}if("showbackground"!=p){var f="block_accessreview_view";if(-1<a.className.search("label")){f+=" alert "+e}var g="<div class=\""+f+"\">";if(0==b){g+=o;g+=q.passed}else{g+=n;g+=q.failed;g+="&nbsp;&nbsp;";g+=b;g+="&nbsp;"+q.errors;g+="&nbsp;&nbsp;";g+=Math.round(100*(b/c));g+=q.percenterrors}g+="</div>";a.insertAdjacentHTML("beforeend",g)}}}function f(){i.forEach(function(a){var b=document.getElementById("section-"+a.section).getElementsByClassName("summary")[0];if(null!==b){e(b,a.numerrors,a.numchecks)}});j.forEach(function(a){var b=document.getElementById("module-"+a.cmid);if(null!==b){e(b,a.numerrors,a.numchecks)}})}function g(){a(".block_accessreview_view").remove();a("*").removeClass(function(a,b){return(b.match(/(^|\s)alert block_accessreview\S+/g)||[]).join(" ")})}var s=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:if(m){g()}else{f()}m=!m;a.next=4;return c.call([{methodname:"block_accessreview_set_toggle_preference",args:{toggle:m}}])[0];case 4:case"end":return a.stop();}}},a)}));return function(){return a.apply(this,arguments)}}();function h(a,b){var c={totalerrors:0,totalusers:0,minviews:0,maxviews:0},d=[];Array.prototype.push.apply(d,a);Array.prototype.push.apply(d,b);d.forEach(function(a){c.totalerrors+=a.numerrors;if(a.numerrors<c.minviews){c.minviews=a.numerrors}if(a.numerrors>c.maxviews){c.maxviews=a.numerrors}c.totalusers+=a.numchecks});return c}return{init:function(){var b=_asyncToGenerator(regeneratorRuntime.mark(function b(e,g,t){var u,v,w;return regeneratorRuntime.wrap(function(b){while(1){switch(b.prev=b.next){case 0:u=c.call([{methodname:"block_accessreview_get_module_data",args:{courseid:t}},{methodname:"block_accessreview_get_section_data",args:{courseid:t}}]);v=r();m=1==e;p=g;b.next=6;return u[0];case 6:j=b.sent;b.next=9;return u[1];case 9:i=b.sent;w=h(i,j);k=w.minviews;l=w.maxviews-w.minviews+1;b.next=15;return v;case 15:b.next=17;return d.renderPix("t/check","core",q.success);case 17:o=b.sent;b.next=20;return d.renderPix("t/block","core",q.errors);case 20:n=b.sent;if(m){f()}a("#toggle-accessmap").click(function(){s()});case 23:case"end":return b.stop();}}},b)}));return function init(){return b.apply(this,arguments)}}()}});
//# sourceMappingURL=module.min.js.map
