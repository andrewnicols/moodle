function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}define ("block_navigation/ajax_response_renderer",["jquery","core/templates","core/notification","core/url"],function($,Templates,Notification,Url){var NODETYPE={ACTIVITY:40,RESOURCE:50};function buildDOM(rootElement,nodes){var ul=$("<ul></ul>");ul.attr("role","group");ul.attr("aria-hidden",!0);$.each(nodes,function(index,node){if("object"!==_typeof(node)){return}var li=$("<li></li>"),p=$("<p></p>"),id=node.id||node.key+"_tree_item",icon=null,isBranch=node.expandable||node.haschildren?!0:!1;p.addClass("tree_item");p.attr("id",id);p.attr("role","treeitem");p.attr("tabindex","-1");if(node.requiresajaxloading){p.attr("data-requires-ajax",!0);p.attr("data-node-id",node.id);p.attr("data-node-key",node.key);p.attr("data-node-type",node.type)}if(isBranch){li.addClass("collapsed contains_branch");p.attr("aria-expanded",!1);p.addClass("branch")}var eleToAddIcon=null;if(node.link){var link=$("<a title=\""+node.title+"\" href=\""+node.link+"\"></a>");eleToAddIcon=link;link.append("<span class=\"item-content-wrap\">"+node.name+"</span>");if(node.hidden){link.addClass("dimmed")}p.append(link)}else{var span=$("<span></span>");eleToAddIcon=span;span.append("<span class=\"item-content-wrap\">"+node.name+"</span>");if(node.hidden){span.addClass("dimmed")}p.append(span)}if(node.icon&&(!isBranch||node.type===NODETYPE.ACTIVITY||node.type===NODETYPE.RESOURCE)){li.addClass("item_with_icon");p.addClass("hasicon");if(node.type===NODETYPE.ACTIVITY||node.type===NODETYPE.RESOURCE){icon=$("<img/>");icon.attr("alt",node.icon.alt);icon.attr("title",node.icon.title);icon.attr("src",Url.imageUrl(node.icon.pix,node.icon.component));$.each(node.icon.classes,function(index,className){icon.addClass(className)});eleToAddIcon.prepend(icon)}else{if("moodle"==node.icon.component){node.icon.component="core"}Templates.renderPix(node.icon.pix,node.icon.component,node.icon.title).then(function(html){eleToAddIcon.prepend(html)}).catch(Notification.exception)}}li.append(p);ul.append(li);if(node.children&&node.children.length){buildDOM(p,node.children)}else if(isBranch&&!node.requiresajaxloading){li.removeClass("contains_branch");p.addClass("emptybranch")}});rootElement.parent().append(ul);var id=rootElement.attr("id")+"_group";ul.attr("id",id);rootElement.attr("aria-owns",id);rootElement.attr("role","treeitem")}return{render:function render(element,nodes){if(nodes.children&&nodes.children.length){buildDOM(element,nodes.children);var item=element.children("[role='treeitem']").first(),group=element.find("#"+item.attr("aria-owns"));item.attr("aria-expanded",!0);group.attr("aria-hidden",!1)}else{if(element.parent().hasClass("contains_branch")){element.parent().removeClass("contains_branch");element.addClass("emptybranch")}}}}});
//# sourceMappingURL=ajax_response_renderer.min.js.map
