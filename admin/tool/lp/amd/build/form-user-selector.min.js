define ("tool_lp/form-user-selector",["jquery","core/ajax","core/templates"],function($,Ajax,Templates){return{processResults:function processResults(selector,results){var users=[];$.each(results,function(index,user){users.push({value:user.id,label:user._label})});return users},transport:function transport(selector,query,success,failure){var promise,capability=$(selector).data("capability");if("undefined"==typeof capability){capability=""}promise=Ajax.call([{methodname:"tool_lp_search_users",args:{query:query,capability:capability}}]);promise[0].then(function(results){var promises=[],i=0;$.each(results.users,function(index,user){var ctx=user,identity=[];$.each(["idnumber","email","phone1","phone2","department","institution"],function(i,k){if("undefined"!=typeof user[k]&&""!==user[k]){ctx.hasidentity=!0;identity.push(user[k])}});ctx.identity=identity.join(", ");promises.push(Templates.render("tool_lp/form-user-selector-suggestion",ctx))});return $.when.apply($.when,promises).then(function(){var args=arguments;$.each(results.users,function(index,user){user._label=args[i];i++});success(results.users)})}).catch(failure)}}});
//# sourceMappingURL=form-user-selector.min.js.map
