define ("tool_moodlenet/select_page",["core/ajax","core/templates","tool_moodlenet/selectors","core/notification"],function(Ajax,Templates,Selectors,Notification){var importId,renderNoCourses=function(areaReplace){return Templates.renderPix("courses","tool_moodlenet").then(function(img){return img}).then(function(img){var temp=document.createElement("div");temp.innerHTML=img.trim();return Templates.render("core_course/no-courses",{nocoursesimg:temp.firstChild.src})}).then(function(html,js){Templates.replaceNodeContents(areaReplace,html,js);areaReplace.classList.add("mx-auto");areaReplace.classList.add("w-25")})},renderCourses=function(areaReplace,courses){return Templates.render("tool_moodlenet/view-cards",{courses:courses}).then(function(html,js){Templates.replaceNodeContents(areaReplace,html,js);areaReplace.classList.remove("mx-auto");areaReplace.classList.remove("w-25")})},searchCourses=function(inputValue,page,areaReplace){var searchIcon=page.querySelector(Selectors.region.searchIcon),clearIcon=page.querySelector(Selectors.region.clearIcon);if(""!==inputValue){searchIcon.classList.add("d-none");clearIcon.parentElement.classList.remove("d-none")}else{searchIcon.classList.remove("d-none");clearIcon.parentElement.classList.add("d-none")}Ajax.call([{methodname:"tool_moodlenet_search_courses",args:{searchvalue:inputValue}}])[0].then(function(result){if(0===result.courses.length){return renderNoCourses(areaReplace)}else{result.courses.forEach(function(course){course.viewurl+="&id="+importId});return renderCourses(areaReplace,result.courses)}}).catch(Notification.exception)},registerListenerEvents=function(page){var input=page.querySelector(Selectors.region.searchInput),courseArea=page.querySelector(Selectors.region.courses),clearIcon=page.querySelector(Selectors.region.clearIcon);clearIcon.addEventListener("click",function(){input.value="";searchCourses("",page,courseArea)});input.addEventListener("input",debounce(function(){searchCourses(input.value,page,courseArea)},300))},addCourses=function(page){var courseArea=page.querySelector(Selectors.region.courses);searchCourses("",page,courseArea)},debounce=function(func,wait,immediate){var timeout;return function(){var context=this,args=arguments,callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(function(){timeout=null;if(!immediate){func.apply(context,args)}},wait);if(callNow){func.apply(context,args)}}};return{init:function(importIdString){importId=importIdString;var page=document.querySelector(Selectors.region.selectPage);registerListenerEvents(page);addCourses(page)}}});
//# sourceMappingURL=select_page.min.js.map
