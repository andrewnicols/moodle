define ("tool_dataprivacy/data_deletion",["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function($,Ajax,Notification,Str,ModalFactory,ModalEvents){var ACTIONS={MARK_FOR_DELETION:"[data-action=\"markfordeletion\"]",SELECT_ALL:"[data-action=\"selectall\"]"},SELECTORS={SELECTCONTEXT:".selectcontext"},DataDeletionActions=function(){this.registerEvents()};DataDeletionActions.prototype.registerEvents=function(){$(ACTIONS.MARK_FOR_DELETION).click(function(e){e.preventDefault();var selectedIds=[];$(SELECTORS.SELECTCONTEXT).each(function(){var checkbox=$(this);if(checkbox.is(":checked")){selectedIds.push(checkbox.val())}});showConfirmation(selectedIds)});$(ACTIONS.SELECT_ALL).change(function(e){e.preventDefault();var selectallnone=$(this);if(selectallnone.is(":checked")){$(SELECTORS.SELECTCONTEXT).attr("checked","checked")}else{$(SELECTORS.SELECTCONTEXT).removeAttr("checked")}})};function showConfirmation(ids){var modalTitle="";Str.get_strings([{key:"confirm",component:"moodle"},{key:"confirmcontextdeletion",component:"tool_dataprivacy"}]).then(function(langStrings){modalTitle=langStrings[0];var confirmMessage=langStrings[1];return ModalFactory.create({title:modalTitle,body:confirmMessage,type:ModalFactory.types.SAVE_CANCEL})}).then(function(modal){modal.setSaveButtonText(modalTitle);modal.getRoot().on(ModalEvents.save,function(){Ajax.call([{methodname:"tool_dataprivacy_confirm_contexts_for_deletion",args:{ids:ids}}])[0].done(function(data){if(data.result){window.location.reload()}else{Notification.addNotification({message:data.warnings[0].message,type:"error"})}}).fail(Notification.exception)});modal.getRoot().on(ModalEvents.hidden,function(){modal.destroy()});return modal}).done(function(modal){modal.show()}).fail(Notification.exception)}return DataDeletionActions});
//# sourceMappingURL=data_deletion.min.js.map
