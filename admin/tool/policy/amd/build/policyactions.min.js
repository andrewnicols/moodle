define ("tool_policy/policyactions",["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events"],function($,Ajax,Notification,ModalFactory,ModalEvents){var PolicyActions=function(root){this.registerEvents(root)};PolicyActions.prototype.registerEvents=function(root){root.on("click",function(e){e.preventDefault();var versionid=$(this).data("versionid"),behalfid=$(this).data("behalfid"),modalTitle=$.Deferred(),modalBody=$.Deferred(),modal=ModalFactory.create({title:modalTitle,body:modalBody,large:!0}).then(function(modal){modal.getRoot().on(ModalEvents.hidden,function(){modal.destroy()});return modal}).then(function(modal){modal.show();return modal}).catch(Notification.exception),promises=Ajax.call([{methodname:"tool_policy_get_policy_version",args:{versionid:versionid,behalfid:behalfid}}]);$.when(promises[0]).then(function(data){if(data.result.policy){modalTitle.resolve(data.result.policy.name);modalBody.resolve(data.result.policy.content);return data}else{throw new Error(data.warnings[0].message)}}).catch(function(message){modal.then(function(modal){modal.hide();modal.destroy();return modal}).catch(Notification.exception);return Notification.addNotification({message:message,type:"error"})})})};return{init:function(root){root=$(root);return new PolicyActions(root)}}});
//# sourceMappingURL=policyactions.min.js.map
