define ("tool_analytics/model",["jquery","core/str","core/log","core/notification","core/modal_factory","core/modal_events","core/templates"],function($,Str,log,Notification,ModalFactory,ModalEvents,Templates){var actionsList={clear:{title:{key:"clearpredictions",component:"tool_analytics"},body:{key:"clearmodelpredictions",component:"tool_analytics"}},delete:{title:{key:"delete",component:"tool_analytics"},body:{key:"deletemodelconfirmation",component:"tool_analytics"}}},getModelName=function(actionItem){var wrap=$(actionItem).closest("[data-model-name]");if(wrap.length){return wrap.attr("data-model-name")}else{log.error("Unexpected DOM error - unable to obtain the model name");return""}};return{confirmAction:function confirmAction(actionId,actionType){$("[data-action-id=\""+actionId+"\"]").on("click",function(ev){ev.preventDefault();var a=$(ev.currentTarget);if("undefined"==typeof actionsList[actionType]){log.error("Action \""+actionType+"\" is not allowed.");return}var reqStrings=[actionsList[actionType].title,actionsList[actionType].body];reqStrings[1].param=getModelName(a);var stringsPromise=Str.get_strings(reqStrings),modalPromise=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL});$.when(stringsPromise,modalPromise).then(function(strings,modal){modal.setTitle(strings[0]);modal.setBody(strings[1]);modal.setSaveButtonText(strings[0]);modal.getRoot().on(ModalEvents.save,function(){window.location.href=a.attr("href")});modal.show();return modal}).fail(Notification.exception)})},selectEvaluationOptions:function selectEvaluationOptions(actionId,trainedOnlyExternally){$("[data-action-id=\""+actionId+"\"]").on("click",function(ev){ev.preventDefault();var a=$(ev.currentTarget),timeSplittingMethods=$(this).attr("data-timesplitting-methods"),stringsPromise=Str.get_strings([{key:"evaluatemodel",component:"tool_analytics"},{key:"evaluate",component:"tool_analytics"}]),modalPromise=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL}),bodyPromise=Templates.render("tool_analytics/evaluation_options",{trainedexternally:trainedOnlyExternally,timesplittingmethods:JSON.parse(timeSplittingMethods)});$.when(stringsPromise,modalPromise).then(function(strings,modal){modal.getRoot().on(ModalEvents.hidden,modal.destroy.bind(modal));modal.setTitle(strings[0]);modal.setSaveButtonText(strings[1]);modal.setBody(bodyPromise);modal.getRoot().on(ModalEvents.save,function(){var evaluationMode=$("input[name='evaluationmode']:checked").val();if("trainedmodel"==evaluationMode){a.attr("href",a.attr("href")+"&mode=trainedmodel")}var timeSplittingMethod=$("#id-evaluation-timesplitting").val();a.attr("href",a.attr("href")+"&timesplitting="+timeSplittingMethod);window.location.href=a.attr("href")});modal.show();return modal}).fail(Notification.exception)})},selectExportOptions:function selectExportOptions(actionId,isTrained){$("[data-action-id=\""+actionId+"\"]").on("click",function(ev){ev.preventDefault();var a=$(ev.currentTarget);if(!isTrained){a.attr("href",a.attr("href")+"&action=exportmodel&includeweights=0");window.location.href=a.attr("href");return}var stringsPromise=Str.get_strings([{key:"export",component:"tool_analytics"}]),modalPromise=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL}),bodyPromise=Templates.render("tool_analytics/export_options",{});$.when(stringsPromise,modalPromise).then(function(strings,modal){modal.getRoot().on(ModalEvents.hidden,modal.destroy.bind(modal));modal.setTitle(strings[0]);modal.setSaveButtonText(strings[0]);modal.setBody(bodyPromise);modal.getRoot().on(ModalEvents.save,function(){var exportOption=$("input[name='exportoption']:checked").val();if("exportdata"==exportOption){a.attr("href",a.attr("href")+"&action=exportdata")}else{a.attr("href",a.attr("href")+"&action=exportmodel");if($("#id-includeweights").is(":checked")){a.attr("href",a.attr("href")+"&includeweights=1")}else{a.attr("href",a.attr("href")+"&includeweights=0")}}window.location.href=a.attr("href")});modal.show();return modal}).fail(Notification.exception)})}}});
//# sourceMappingURL=model.min.js.map
