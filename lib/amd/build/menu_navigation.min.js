define ("core/menu_navigation",["exports","core/key_codes"],function(_exports,_key_codes){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;var SELECTORS={menuitem:"[role=\"menuitem\"]",menu:"[role=\"menu\"]"},openDropdownNode=null,clickErrorHandler=function(item,fallback){if(null!==item){return item}else{return fallback}},menuItemHelper=function(src){var parent;if(src.classList.contains("dropdown-item")){parent=src.closest(".dropdown-menu");parent.previousElementSibling.classList.add("active")}else{parent=src.parentElement.parentElement.querySelector(".dropdown-menu")}Array.prototype.forEach.call(parent.children,function(node){var menuItem=node.querySelector(SELECTORS.menuitem);if(null!==menuItem){menuItem.classList.remove("active");menuItem.setAttribute("aria-current","false")}node.setAttribute("aria-current","false")});src.setAttribute("aria-current","true")},keyboardListenerEvents=function(e){var src=e.srcElement,firstNode=e.currentTarget.firstElementChild,lastNode=findUsableLastNode(e.currentTarget);if(src.classList.contains("dropdown-item")){if(e.keyCode===_key_codes.arrowRight||e.keyCode===_key_codes.arrowLeft){e.preventDefault();if(null!==openDropdownNode){openDropdownNode.parentElement.click()}}if(e.keyCode===_key_codes.space||e.keyCode===_key_codes.enter){e.preventDefault();menuItemHelper(src);if(!src.parentElement.classList.contains("dropdown")){src.click()}}}else{if(e.keyCode===_key_codes.arrowRight){e.preventDefault();setFocusNext(src,firstNode)}if(e.keyCode===_key_codes.arrowLeft){e.preventDefault();setFocusPrev(src,lastNode)}if(e.keyCode===_key_codes.arrowUp||e.keyCode===_key_codes.arrowDown){openDropdownNode=src;e.preventDefault()}if(e.keyCode===_key_codes.home){e.preventDefault();src.setAttribute("aria-current","false");setFocusHomeEnd(firstNode)}if(e.keyCode===_key_codes.end){e.preventDefault();src.currentNode.setAttribute("aria-current","false");setFocusHomeEnd(lastNode)}if(e.keyCode===_key_codes.space||e.keyCode===_key_codes.enter){e.preventDefault();if(!src.parentElement.classList.contains("dropdown")){src.click()}}}},clickListenerEvents=function(e){var src=e.srcElement;menuItemHelper(src)};_exports.default=function(elementRoot){elementRoot.removeEventListener("keydown",keyboardListenerEvents);elementRoot.removeEventListener("click",clickListenerEvents);elementRoot.addEventListener("keydown",keyboardListenerEvents);elementRoot.addEventListener("click",clickListenerEvents)};var setFocusNext=function(currentNode,firstNode){var nextListItem=currentNode.parentElement.nextElementSibling,nodeToSelect=clickErrorHandler(nextListItem,firstNode),menuItem=nodeToSelect.querySelector(SELECTORS.menuitem);currentNode.setAttribute("aria-current","false");menuItem.setAttribute("aria-current","true");menuItem.focus()},setFocusPrev=function(currentNode,lastNode){var nextListItem=currentNode.parentElement.previousElementSibling,nodeToSelect=clickErrorHandler(nextListItem,lastNode),menuItem=nodeToSelect.querySelector(SELECTORS.menuitem);currentNode.setAttribute("aria-current","false");menuItem.setAttribute("aria-current","true");menuItem.focus()},setFocusHomeEnd=function(node){node.querySelector(SELECTORS.menuitem).focus();node.querySelector(SELECTORS.menuitem).setAttribute("aria-current","true")},findUsableLastNode=function(elementRoot){var lastNode=elementRoot.lastElementChild;if(!lastNode.classList.contains("d-none")){return elementRoot.lastElementChild}else{var extractedNodes=Array.prototype.map.call(elementRoot.children,function(node){return node}).reverse(),nodesToUse=extractedNodes.filter(function(node){if(!node.classList.contains("d-none")){return node}});if(0!==nodesToUse.length){return nodesToUse[0]}else{return elementRoot.firstElementChild}}};return _exports.default});
//# sourceMappingURL=menu_navigation.min.js.map
