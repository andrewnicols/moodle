define ("core/moremenu",["exports","jquery","core/menu_navigation"],function(_exports,_jquery,_menu_navigation){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_jquery=_interopRequireDefault(_jquery);_menu_navigation=_interopRequireDefault(_menu_navigation);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const Selectors={regions:{moredropdown:"[data-region=\"moredropdown\"]",morebutton:"[data-region=\"morebutton\"]"},classes:{dropdownitem:"dropdown-item",dropdownmoremenu:"dropdownmoremenu",hidden:"d-none",active:"active",nav:"nav",navlink:"nav-link",observed:"observed"},attributes:{menu:"[role=\"menu\"]",dropdowntoggle:"[data-toggle=\"dropdown\"]"}},autoCollapse=menu=>{const maxHeight=menu.parentNode.offsetHeight+1,moreDropdown=menu.querySelector(Selectors.regions.moredropdown),moreButton=menu.querySelector(Selectors.regions.morebutton);if(menu.offsetHeight>maxHeight){moreButton.classList.remove(Selectors.classes.hidden);const menuNodes=Array.from(menu.children).reverse();menuNodes.forEach(item=>{if(!item.classList.contains(Selectors.classes.dropdownmoremenu)){if(menu.offsetHeight>maxHeight){const lastNode=menu.removeChild(item);moveIntoMoreDropdown(menu,lastNode,!0)}}})}else{if("children"in moreDropdown){Array.from(moreDropdown.children).forEach(item=>{if(menu.offsetHeight<maxHeight&&"true"!==item.dataset.forceintomoremenu){const lastNode=moreDropdown.removeChild(item);moveOutOfMoreDropdown(menu,lastNode)}});if(0===Array.from(moreDropdown.children).length){moreButton.classList.add(Selectors.classes.hidden)}}if(menu.offsetHeight>maxHeight){autoCollapse(menu)}}menu.parentNode.classList.add(Selectors.classes.observed)},moveIntoMoreDropdown=function(menu,navNode){let prepend=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!1;const moreDropdown=menu.querySelector(Selectors.regions.moredropdown),dropdownToggle=menu.querySelector(Selectors.attributes.dropdowntoggle),navLink=navNode.querySelector("."+Selectors.classes.navlink);if(navLink.classList.contains(Selectors.classes.active)){dropdownToggle.classList.add(Selectors.classes.active)}navLink.classList.remove(Selectors.classes.navlink);navLink.classList.add(Selectors.classes.dropdownitem);if(prepend){moreDropdown.prepend(navNode)}else{moreDropdown.append(navNode)}},moveOutOfMoreDropdown=(menu,navNode)=>{const moreButton=menu.querySelector(Selectors.regions.morebutton),dropdownToggle=menu.querySelector(Selectors.attributes.dropdowntoggle),navLink=navNode.querySelector("."+Selectors.classes.dropdownitem);if(navLink.classList.contains(Selectors.classes.active)){dropdownToggle.classList.remove(Selectors.classes.active)}navLink.classList.remove(Selectors.classes.dropdownitem);navLink.classList.add(Selectors.classes.navlink);menu.insertBefore(navNode,moreButton)};var _default=menu=>{menu.firstElementChild.querySelector("[role=\"menuitem\"]").setAttribute("tabindex","0");if("children"in menu){const moreButton=menu.querySelector(Selectors.regions.morebutton),menuNodes=Array.from(menu.children);menuNodes.forEach(item=>{if(!item.classList.contains(Selectors.classes.dropdownmoremenu)&&"true"===item.dataset.forceintomoremenu){moveIntoMoreDropdown(menu,item,!1);if(moreButton.classList.contains(Selectors.classes.hidden)){moreButton.classList.remove(Selectors.classes.hidden)}}})}autoCollapse(menu);(0,_menu_navigation.default)(menu);window.addEventListener("resize",()=>{autoCollapse(menu);(0,_menu_navigation.default)(menu)});const toggledropdown=e=>{const innerMenu=e.target.parentNode.querySelector(Selectors.attributes.menu);if(innerMenu){innerMenu.classList.toggle("show")}e.stopPropagation()};(0,_jquery.default)("."+Selectors.classes.dropdownmoremenu).on("show.bs.dropdown",function(){const moreDropdown=menu.querySelector(Selectors.regions.moredropdown);moreDropdown.querySelectorAll(".dropdown").forEach(dropdown=>{dropdown.removeEventListener("click",toggledropdown,!0);dropdown.addEventListener("click",toggledropdown,!0)})})};_exports.default=_default;return _exports.default});
//# sourceMappingURL=moremenu.min.js.map
