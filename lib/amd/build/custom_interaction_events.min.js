define ("core/custom_interaction_events",["jquery","core/key_codes"],function($,keyCodes){var events={activate:"cie:activate",keyboardActivate:"cie:keyboardactivate",escape:"cie:escape",down:"cie:down",up:"cie:up",home:"cie:home",end:"cie:end",next:"cie:next",previous:"cie:previous",asterix:"cie:asterix",scrollLock:"cie:scrollLock",scrollTop:"cie:scrollTop",scrollBottom:"cie:scrollBottom",ctrlPageUp:"cie:ctrlPageUp",ctrlPageDown:"cie:ctrlPageDown",enter:"cie:enter",accessibleChange:"cie:accessibleChange"},triggeredEvents={},shouldAddEvent=function(eventType,include){include=include||[];if(include.length&&-1!==include.indexOf(eventType)){return!0}return!1},isModifierPressed=function(e){return e.shiftKey||e.metaKey||e.altKey||e.ctrlKey},triggerEvent=function(eventName,e){var eventTypeKey="";if(!e.hasOwnProperty("originalEvent")){eventTypeKey=""+eventName+e.type+e.timeStamp;if(!triggeredEvents.hasOwnProperty(eventTypeKey)){triggeredEvents[eventTypeKey]=!0;$(e.target).trigger(eventName,[{originalEvent:e}])}return}eventTypeKey="triggeredCustom_"+eventName;if(!e.originalEvent.hasOwnProperty(eventTypeKey)){e.originalEvent[eventTypeKey]=!0;$(e.target).trigger(eventName,[{originalEvent:e}])}},addKeyboardEvent=function(element,event,keyCode){element.off("keydown."+event).on("keydown."+event,function(e){if(!isModifierPressed(e)){if(e.keyCode==keyCode){triggerEvent(event,e)}}})},addActivateListener=function(element){element.off("click.cie.activate").on("click.cie.activate",function(e){triggerEvent(events.activate,e)});element.off("keydown.cie.activate").on("keydown.cie.activate",function(e){if(!isModifierPressed(e)){if(e.keyCode==keyCodes.enter||e.keyCode==keyCodes.space){triggerEvent(events.activate,e)}}})},addKeyboardActivateListener=function(element){element.off("keydown.cie.keyboardactivate").on("keydown.cie.keyboardactivate",function(e){if(!isModifierPressed(e)){if(e.keyCode==keyCodes.enter||e.keyCode==keyCodes.space){triggerEvent(events.keyboardActivate,e)}}})},addEscapeListener=function(element){addKeyboardEvent(element,events.escape,keyCodes.escape)},addDownListener=function(element){addKeyboardEvent(element,events.down,keyCodes.arrowDown)},addUpListener=function(element){addKeyboardEvent(element,events.up,keyCodes.arrowUp)},addHomeListener=function(element){addKeyboardEvent(element,events.home,keyCodes.home)},addEndListener=function(element){addKeyboardEvent(element,events.end,keyCodes.end)},addNextListener=function(element){var keyCode="rtl"==$("html").attr("dir")?keyCodes.arrowLeft:keyCodes.arrowRight;addKeyboardEvent(element,events.next,keyCode)},addPreviousListener=function(element){var keyCode="rtl"==$("html").attr("dir")?keyCodes.arrowRight:keyCodes.arrowLeft;addKeyboardEvent(element,events.previous,keyCode)},addAsterixListener=function(element){addKeyboardEvent(element,events.asterix,keyCodes.asterix)},addScrollTopListener=function(element){element.off("scroll.cie.scrollTop").on("scroll.cie.scrollTop",function(e){var scrollTop=element.scrollTop();if(0===scrollTop){triggerEvent(events.scrollTop,e)}})},addScrollBottomListener=function(element){element.off("scroll.cie.scrollBottom").on("scroll.cie.scrollBottom",function(e){var scrollTop=element.scrollTop(),innerHeight=element.innerHeight(),scrollHeight=element[0].scrollHeight;if(scrollTop+innerHeight>=scrollHeight){triggerEvent(events.scrollBottom,e)}})},addScrollLockListener=function(element){element.off("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock").on("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock",function(e){var scrollTop=element.scrollTop(),scrollHeight=element[0].scrollHeight,height=element.height(),delta="DOMMouseScroll"==e.type?-40*e.originalEvent.detail:e.originalEvent.wheelDelta,up=0<delta;if(!up&&-delta>scrollHeight-height-scrollTop){element.scrollTop(scrollHeight);e.stopPropagation();e.preventDefault();e.returnValue=!1;triggerEvent(events.scrollLock,e);return!1}else if(up&&delta>scrollTop){element.scrollTop(0);e.stopPropagation();e.preventDefault();e.returnValue=!1;triggerEvent(events.scrollLock,e);return!1}return!0})},addCtrlPageUpListener=function(element){element.off("keydown.cie.ctrlpageup").on("keydown.cie.ctrlpageup",function(e){if(e.ctrlKey){if(e.keyCode==keyCodes.pageUp){triggerEvent(events.ctrlPageUp,e)}}})},addCtrlPageDownListener=function(element){element.off("keydown.cie.ctrlpagedown").on("keydown.cie.ctrlpagedown",function(e){if(e.ctrlKey){if(e.keyCode==keyCodes.pageDown){triggerEvent(events.ctrlPageDown,e)}}})},addEnterListener=function(element){addKeyboardEvent(element,events.enter,keyCodes.enter)},addAccessibleChangeListener=function(element){var onMac=-1!==navigator.userAgent.indexOf("Macintosh"),touchEnabled="ontouchstart"in window||"msMaxTouchPoints"in navigator&&0<navigator.msMaxTouchPoints;if(onMac||touchEnabled){element.on("change",function(e){triggerEvent(events.accessibleChange,e)})}else{var setInitialValue=function(target){target.dataset.initValue=target.value},resetToInitialValue=function(target){if("initValue"in target.dataset){target.value=target.dataset.initValue}},checkAndTriggerAccessibleChange=function(e){if(!("initValue"in e.target.dataset)){return}if(e.target.value!==e.target.dataset.initValue){e.target.dataset.initValue=e.target.value;triggerEvent(events.accessibleChange,e)}},nativeElement=element.get()[0];nativeElement.addEventListener("focus",function(e){setInitialValue(e.target)},!0);nativeElement.addEventListener("blur",function(e){checkAndTriggerAccessibleChange(e)},!0);element.on("keydown",function(e){if(e.which===keyCodes.enter){checkAndTriggerAccessibleChange(e)}else if(e.which===keyCodes.escape){resetToInitialValue(e.target);e.target.dataset.ignoreChange=!0}else{e.target.dataset.ignoreChange=!0}});element.on("change",function(e){if(e.target.dataset.ignoreChange){return}checkAndTriggerAccessibleChange(e)});element.on("keyup",function(e){delete e.target.dataset.ignoreChange});element.on("click",function(e){checkAndTriggerAccessibleChange(e)})}},getHandlers=function(){var handlers={};handlers[events.activate]=addActivateListener;handlers[events.keyboardActivate]=addKeyboardActivateListener;handlers[events.escape]=addEscapeListener;handlers[events.down]=addDownListener;handlers[events.up]=addUpListener;handlers[events.home]=addHomeListener;handlers[events.end]=addEndListener;handlers[events.next]=addNextListener;handlers[events.previous]=addPreviousListener;handlers[events.asterix]=addAsterixListener;handlers[events.scrollLock]=addScrollLockListener;handlers[events.scrollTop]=addScrollTopListener;handlers[events.scrollBottom]=addScrollBottomListener;handlers[events.ctrlPageUp]=addCtrlPageUpListener;handlers[events.ctrlPageDown]=addCtrlPageDownListener;handlers[events.enter]=addEnterListener;handlers[events.accessibleChange]=addAccessibleChangeListener;return handlers};return{define:function(element,include){element=$(element);include=include||[];if(!element.length||!include.length){return}$.each(getHandlers(),function(eventType,handler){if(shouldAddEvent(eventType,include)){handler(element)}})},events:events}});
//# sourceMappingURL=custom_interaction_events.min.js.map
