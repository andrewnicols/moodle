define ("core/checkbox-toggleall",["jquery","core/pubsub"],function($,PubSub){var registered=!1,events={checkboxToggled:"core/checkbox-toggleall:checkboxToggled"},getToggleGroupElements=function(root,toggleGroup,exactMatch){if(exactMatch){return root.find("[data-action=\"toggle\"][data-togglegroup=\""+toggleGroup+"\"]")}else{return root.find("[data-action=\"toggle\"][data-togglegroup^=\""+toggleGroup+"\"]")}},getAllSlaveCheckboxes=function(root,toggleGroup){return getToggleGroupElements(root,toggleGroup,!1).filter("[data-toggle=\"slave\"]")},getControlCheckboxes=function(root,toggleGroup,exactMatch){return getToggleGroupElements(root,toggleGroup,exactMatch).filter("[data-toggle=\"master\"]")},getActionElements=function(root,toggleGroup){return getToggleGroupElements(root,toggleGroup,!0).filter("[data-toggle=\"action\"]")},toggleSlavesFromMasters=function(e){var root=e.data.root,target=$(e.target),toggleGroupName=target.data("togglegroup"),targetState;if(target.is(":checkbox")){targetState=target.is(":checked")}else{targetState=1===target.data("checkall")}toggleSlavesToState(root,toggleGroupName,targetState)},toggleMastersAndActionElements=function(root,toggleGroupName){var toggleGroupSlaves=getAllSlaveCheckboxes(root,toggleGroupName);if(0<toggleGroupSlaves.length){var toggleGroupCheckedSlaves=toggleGroupSlaves.filter(":checked"),targetState=toggleGroupSlaves.length===toggleGroupCheckedSlaves.length;setMasterStates(root,toggleGroupName,targetState,!0);setActionElementStates(root,toggleGroupName,!toggleGroupCheckedSlaves.length)}},getToggleGroupLevels=function(toggleGroupName){var toggleGroups=toggleGroupName.split(" "),toggleGroupLevels=[],toggleGroupLevel="";toggleGroups.forEach(function(toggleGroupName){toggleGroupLevel+=" "+toggleGroupName;toggleGroupLevels.push(toggleGroupLevel.trim())});return toggleGroupLevels},toggleSlavesToState=function(root,toggleGroupName,targetState){var slaves=getAllSlaveCheckboxes(root,toggleGroupName);slaves.prop("checked",targetState).trigger("change");var checkedSlaves=slaves.filter(":checked");setMasterStates(root,toggleGroupName,targetState,!1);setActionElementStates(root,toggleGroupName,!checkedSlaves.length);var toggleGroupLevels=getToggleGroupLevels(toggleGroupName).filter(function(toggleGroupLevel){return toggleGroupLevel!==toggleGroupName});toggleGroupLevels.forEach(function(toggleGroupLevel){toggleMastersAndActionElements(root,toggleGroupLevel)});PubSub.publish(events.checkboxToggled,{root:root,toggleGroupName:toggleGroupName,slaves:slaves,checkedSlaves:checkedSlaves,anyChecked:targetState})},toggleMastersFromSlaves=function(e){var root=e.data.root,target=$(e.target),toggleGroupName=target.data("togglegroup"),slaves=getAllSlaveCheckboxes(root,toggleGroupName),checkedSlaves=slaves.filter(":checked"),toggleGroupLevels=getToggleGroupLevels(toggleGroupName);toggleGroupLevels.forEach(function(toggleGroupLevel){toggleMastersAndActionElements(root,toggleGroupLevel)});PubSub.publish(events.checkboxToggled,{root:root,toggleGroupName:toggleGroupName,slaves:slaves,checkedSlaves:checkedSlaves,anyChecked:!!checkedSlaves.length})},setActionElementStates=function(root,toggleGroupName,disableActionElements){getActionElements(root,toggleGroupName).prop("disabled",disableActionElements)},setMasterStates=function(root,toggleGroupName,targetState,exactMatch){var masters=getControlCheckboxes(root,toggleGroupName,exactMatch);masters.prop("checked",targetState);masters.each(function(i,masterElement){masterElement=$(masterElement);var targetString;if(targetState){targetString=masterElement.data("toggle-deselectall")}else{targetString=masterElement.data("toggle-selectall")}if(masterElement.is(":checkbox")){var masterLabel=root.find("[for=\""+masterElement.attr("id")+"\"]");if(masterLabel.length){if(masterLabel.html()!==targetString){masterLabel.html(targetString)}}}else{masterElement.text(targetString);masterElement.data("checkall",targetState?0:1)}})},registerListeners=function(){if(!registered){registered=!0;var root=$(document.body);root.on("click","[data-action=\"toggle\"][data-toggle=\"master\"]",{root:root},toggleSlavesFromMasters);root.on("click","[data-action=\"toggle\"][data-toggle=\"slave\"]",{root:root},toggleMastersFromSlaves)}};return{init:function init(){registerListeners()},events:events,setGroupState:function setGroupState(root,toggleGroupName,targetState){root=$(root);setMasterStates(root,toggleGroupName,targetState,!0);toggleSlavesToState(root,toggleGroupName,targetState)},updateSlavesFromMasterState:function updateSlavesFromMasterState(root,toggleGroupName){root=$(root);var target=getControlCheckboxes(root,toggleGroupName,!1),targetState;if(target.is(":checkbox")){targetState=target.is(":checked")}else{targetState=1===target.data("checkall")}toggleSlavesToState(root,toggleGroupName,targetState)}}});
//# sourceMappingURL=checkbox-toggleall.min.js.map
