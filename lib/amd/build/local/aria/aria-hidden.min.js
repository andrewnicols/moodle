define ("core/local/aria/aria-hidden",["exports","core/normalise","./selectors"],function(_exports,_normalise,_selectors){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.unhideSiblings=_exports.unhide=_exports.hideSiblings=_exports.hide=void 0;_selectors=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_selectors);var childObserverMap=new Map,siblingObserverMap=new Map,supportsMutationObservers=function(){return MutationObserver&&"function"==typeof MutationObserver},disableElementFocusability=function(target){if(!(target instanceof HTMLElement)){return}if(target.matches(_selectors.default.elements.focusable)){disableAndStoreTabIndex(target)}target.querySelectorAll(_selectors.default.elements.focusable).forEach(disableAndStoreTabIndex)},disableAndStoreTabIndex=function(element){if("undefined"!=typeof element.dataset.ariaHiddenTabIndex){return}if(element.getAttribute("tabindex")){element.dataset.ariaHiddenTabIndex=element.getAttribute("tabindex")}else{element.dataset.ariaHiddenTabIndex=""}element.setAttribute("tabindex",-1)},enableElementFocusability=function(target){if(!(target instanceof HTMLElement)){return}if(target.matches(_selectors.default.elements.focusableToUnhide)){restoreTabIndex(target)}target.querySelectorAll(_selectors.default.elements.focusableToUnhide).forEach(restoreTabIndex)},restoreTabIndex=function(element){if(element.closest(_selectors.default.aria.hidden)){return}var oldTabIndex=element.dataset.ariaHiddenTabIndex;if(""===oldTabIndex){element.removeAttribute("tabindex")}else{element.setAttribute("tabindex",oldTabIndex)}delete element.dataset.ariaHiddenTabIndex},hide=function(target){return(0,_normalise.getList)(target).forEach(_hide)};_exports.hide=hide;var _hide=function(target){if(!(target instanceof HTMLElement)){return}if(target.closest(_selectors.default.aria.hidden)){return}target.setAttribute("aria-hidden",!0);disableElementFocusability(target);if(supportsMutationObservers()){var mutationObserver=new MutationObserver(function(mutationList){mutationList.forEach(function(mutation){if("childList"===mutation.type){mutation.addedNodes.forEach(disableElementFocusability)}else if("attributes"===mutation.type){var element=mutation.target,proposedTabIndex=element.getAttribute("tabindex");if("-1"!==proposedTabIndex){element.dataset.ariaHiddenTabIndex=proposedTabIndex;element.setAttribute("tabindex",-1)}}})});mutationObserver.observe(target,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabindex"]});childObserverMap.set(target,mutationObserver)}},unhide=function(target){return(0,_normalise.getList)(target).forEach(_unhide)};_exports.unhide=unhide;var _unhide=function(target){if(!(target instanceof HTMLElement)){return}target.removeAttribute("aria-hidden");enableElementFocusability(target);if(childObserverMap.has(target)){childObserverMap.get(target).disconnect();childObserverMap.delete(target)}};_exports.hideSiblings=function hideSiblings(target){return(0,_normalise.getList)(target).forEach(_hideSiblings)};var _hideSiblings=function(target){if(!(target instanceof HTMLElement)){return}if(!target.parentElement){return}target.parentElement.childNodes.forEach(function(node){if(node===target){return}hide(node)});if(supportsMutationObservers()){var newNodeObserver=new MutationObserver(function(mutationList){mutationList.forEach(function(mutation){mutation.addedNodes.forEach(function(node){if(target.contains(node)){return}hide(node)})})});newNodeObserver.observe(target.parentElement,{childList:!0,subtree:!0});siblingObserverMap.set(target.parentElement,newNodeObserver)}};_exports.unhideSiblings=function unhideSiblings(target){return(0,_normalise.getList)(target).forEach(_unhideSiblings)};var _unhideSiblings=function(target){if(!(target instanceof HTMLElement)){return}if(!target.parentElement){return}target.parentElement.childNodes.forEach(function(node){if(node===target){return}unhide(node)});if(siblingObserverMap.has(target.parentElement)){siblingObserverMap.get(target.parentElement).disconnect();siblingObserverMap.delete(target.parentElement)}}});
//# sourceMappingURL=aria-hidden.min.js.map
