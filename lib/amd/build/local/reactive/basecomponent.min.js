define ("core/local/reactive/basecomponent",["exports","core/templates"],function(_exports,_templates){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_templates=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_templates);class _default{constructor(descriptor){if(descriptor.element===void 0||!(descriptor.element instanceof HTMLElement)){throw Error("Reactive components needs a main DOM element to dispatch events")}this.element=descriptor.element;this.eventHandlers=new Map([]);this.eventListeners=[];this.selectors={};this.events=this.constructor.getEvents();this.create(descriptor);if(descriptor.selectors!==void 0){this.addSelectors(descriptor.selectors)}if(descriptor.reactive===void 0){this.element.dispatchEvent(new CustomEvent("core/reactive:requestRegistration",{bubbles:!0,detail:{component:this}}))}else{this.reactive=descriptor.reactive;this.reactive.registerComponent(this);this.addEventListener(this.element,"core/reactive:requestRegistration",event=>{var _event$detail;if(null!==event&&void 0!==event&&null!==(_event$detail=event.detail)&&void 0!==_event$detail&&_event$detail.component){event.stopPropagation();this.registerChildComponent(event.detail.component)}})}}static getEvents(){return{}}create(){}destroy(){}getWatchers(){return[]}stateReady(){}getElement(query,dataId){if(query===void 0&&dataId===void 0){return this.element}const dataSelector=dataId?"[data-id='".concat(dataId,"']"):"",selector="".concat(null!==query&&void 0!==query?query:"").concat(dataSelector);return this.element.querySelector(selector)}getElements(query,dataId){const dataSelector=dataId?"[data-id='".concat(dataId,"']"):"",selector="".concat(null!==query&&void 0!==query?query:"").concat(dataSelector);return this.element.querySelectorAll(selector)}addSelectors(newSelectors){for(const[selectorName,selector]of Object.entries(newSelectors)){this.selectors[selectorName]=selector}}getSelector(selectorName){return this.selectors[selectorName]}dispatchEvent(eventName,detail){this.element.dispatchEvent(new CustomEvent(eventName,{bubbles:!0,detail:detail}))}renderComponent(target,file,data){return new Promise((resolve,reject)=>{target.addEventListener("ComponentRegistration:Success",_ref=>{let{detail}=_ref;resolve(detail.component)});target.addEventListener("ComponentRegistration:Fail",()=>{reject("Registration of ".concat(file," fails."))});_templates.default.renderForPromise(file,data).then(_ref2=>{let{html,js}=_ref2;_templates.default.replaceNodeContents(target,html,js);return!0}).catch(error=>{reject("Rendering of ".concat(file," throws an error."));throw error})})}addEventListener(target,type,listener){let bindListener=this.eventHandlers.get(listener);if(bindListener===void 0){bindListener=listener.bind(this);this.eventHandlers.set(listener,bindListener)}target.addEventListener(type,bindListener);this.eventListeners.push({target,type,bindListener})}removeEventListener(target,type,listener){let bindListener=this.eventHandlers.get(listener);if(bindListener===void 0){return}target.removeEventListener(type,bindListener)}removeAllEventListeners(){this.eventListeners.forEach(_ref3=>{let{target,type,bindListener}=_ref3;target.removeEventListener(type,bindListener)});this.eventListeners=[]}remove(){this.unregister();this.element.remove()}unregister(){this.reactive.unregisterComponent(this);this.removeAllEventListeners();this.destroy()}dispatchRegistrationSuccess(){if(this.element.parentNode===void 0){return}this.element.parentNode.dispatchEvent(new CustomEvent("ComponentRegistration:Success",{bubbles:!1,detail:{component:this}}))}dispatchRegistrationFail(){if(this.element.parentNode===void 0){return}this.element.parentNode.dispatchEvent(new CustomEvent("ComponentRegistration:Fail",{bubbles:!1,detail:{component:this}}))}registerChildComponent(component){component.reactive=this.reactive;this.reactive.registerComponent(component)}set locked(locked){this.setElementLocked(this.element,locked)}get locked(){return this.getElementLocked(this.element)}setElementLocked(target,locked){target.dataset.locked=null!==locked&&void 0!==locked?locked:!1;if(locked){target.style.pointerEvents="none";target.style.userSelect="none";if(target.hasAttribute("draggable")){target.setAttribute("draggable",!1)}target.setAttribute("aria-busy",!0)}else{target.style.pointerEvents=null;target.style.userSelect=null;if(target.hasAttribute("draggable")){target.setAttribute("draggable",!0)}target.setAttribute("aria-busy",!1)}}getElementLocked(target){var _target$dataset$locke;return null!==(_target$dataset$locke=target.dataset.locked)&&void 0!==_target$dataset$locke?_target$dataset$locke:!1}}_exports.default=_default;return _exports.default});
//# sourceMappingURL=basecomponent.min.js.map
