define("core/storagewrapper",["exports","core/config"],(function(_exports,_config){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_config=(obj=_config)&&obj.__esModule?obj:{default:obj};class StorageWrapper{constructor(storage){this.storage=storage,this.hashSource="".concat(_config.default.wwwroot,"/").concat(this.cacheRevision),this.hash=this.hashString(this.hashSource),this.prefix="".concat(this.hash),this.jsrevPrefix="".concat(this.hashString(_config.default.wwwroot),"/jsrev"),this.validateCache()}get cacheRevision(){if(!this.cacheRevisionValue){if(-1!==_config.default.jsrev)return this.cacheRevisionValue=_config.default.jsrev,_config.default.jsrev;this.cacheRevisionValue=0-10*Math.floor(Date.now()/1e3/10)}return this.cacheRevisionValue}get supported(){return void 0!==this.storage&&null!==this.storage}prefixKey(key){return this.prefix+key}validateCache(){if(!this.supported)return;const cacheVersion=this.storage.getItem(this.jsrevPrefix);if(null===cacheVersion)return void this.storage.setItem(this.jsrevPrefix,this.cacheRevision);this.cacheRevision!=cacheVersion&&(this.storage.clear(),this.storage.setItem(this.jsrevPrefix,this.cacheRevision))}hashString(source){let i,hash=0;if(0===source.length)return hash;for(i=0;i<source.length;i++)hash=(hash<<5)-hash+source.charCodeAt(i),hash|=0;return hash}get(key){return!!this.supported&&this.storage.getItem(this.prefixKey(key))}static get(key){return(new this).get(key)}set(key,value){if(!this.supported)return!1;try{this.storage.setItem(this.prefixKey(key),value)}catch(e){return window.console.warn("Error saving to storage: ".concat(e.message)),!1}return!0}static set(key,value){return(new this).set(key,value)}}return _exports.default=StorageWrapper,function(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(StorageWrapper,"cacheRevisionValue",void 0),_exports.default}));

//# sourceMappingURL=storagewrapper.min.js.map