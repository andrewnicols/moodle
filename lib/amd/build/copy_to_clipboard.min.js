define ("core/copy_to_clipboard",["core/str","core/toast","core/prefetch"],function(_str,_toast,_prefetch){"use strict";var addEventListeners=function(){document.addEventListener("click",function(e){var copyButton=e.target.closest("[data-action=\"copytoclipboard\"]");if(!copyButton){return}if(!copyButton.dataset.clipboardTarget){return}var copyTarget=document.querySelector(copyButton.dataset.clipboardTarget);if(!copyTarget){return}e.preventDefault();var textToCopy=getTextFromContainer(copyTarget);if(!textToCopy){displayFailureToast();return}if(navigator.clipboard){navigator.clipboard.writeText(textToCopy).then(function(){return displaySuccessToast(copyButton)}).catch();return}if(copyTarget instanceof HTMLInputElement||copyTarget instanceof HTMLTextAreaElement){copyTarget.focus();if(copyNodeContentToClipboard(copyButton,copyTarget)){copyButton.focus()}}else{var copyRegion=document.createElement("textarea");copyRegion.value=textToCopy;copyRegion.classList.add("sr-only");document.body.appendChild(copyRegion);copyNodeContentToClipboard(copyButton,copyRegion);copyRegion.remove();copyButton.focus()}})},copyNodeContentToClipboard=function(copyButton,copyTarget){copyTarget.select();if(document.execCommand("copy")){displaySuccessToast(copyButton);return!0}displayFailureToast();return!1},displaySuccessToast=function(copyButton){return getSuccessText(copyButton).then(function(successMessage){return(0,_toast.add)(successMessage,{})})},displayFailureToast=function(){return getFailureText().then(function(message){return(0,_toast.add)(message,{type:"warning"})})},getFailureText=function(){return(0,_str.get_string)("unabletocopytoclipboard","core")},getSuccessText=function(copyButton){if(copyButton.dataset.clipboardSuccessMessage){return Promise.resolve(copyButton.dataset.clipboardSuccessMessage)}return(0,_str.get_string)("textcopiedtoclipboard","core")},getTextFromContainer=function(container){if(container.value){return container.value}else if(container.innerText){return container.innerText}return null},loaded=!1;if(!loaded){(0,_prefetch.prefetchStrings)("core",["textcopiedtoclipboard","unabletocopytoclipboard"]);addEventListeners();loaded=!0}});
//# sourceMappingURL=copy_to_clipboard.min.js.map
