define ("core/prefetch",["exports","core/config"],function(_exports,_config){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_config=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_config);var _systemImportTransformerGlobalIdentifier="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof global?global:{};function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor)n=o.constructor.name;if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _arrayLikeToArray(arr,len){if(null==len||len>arr.length)len=arr.length;for(var i=0,arr2=Array(len);i<len;i++){arr2[i]=arr[i]}return arr2}var initialPrefetchComplete=!1,templateList=[],stringList={},prefetchTimer,fetchQueue=function(){if(templateList){var templatesToLoad=templateList.slice();templateList=[];("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise(function(resolve,reject){_systemImportTransformerGlobalIdentifier.require(["core/templates"],resolve,reject)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require(("core/templates"))):Promise.resolve(_systemImportTransformerGlobalIdentifier["core/templates"])).then(function(Templates){return Templates.prefetchTemplates(templatesToLoad)}).catch()}var mappedStringsToFetch=stringList;stringList={};var stringsToFetch=[];Object.keys(mappedStringsToFetch).forEach(function(component){stringsToFetch.push.apply(stringsToFetch,_toConsumableArray(mappedStringsToFetch[component].map(function(key){return{component:component,key:key}})))});("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise(function(resolve,reject){_systemImportTransformerGlobalIdentifier.require(["core/str"],resolve,reject)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require(("core/str"))):Promise.resolve(_systemImportTransformerGlobalIdentifier["core/str"])).then(function(Str){return Str.get_strings(stringsToFetch)}).catch()},processQueue=function(){if(prefetchTimer){return}if(initialPrefetchComplete){fetchQueue();return}prefetchTimer=setTimeout(function(){initialPrefetchComplete=!0;prefetchTimer=null;("function"==typeof _systemImportTransformerGlobalIdentifier.define&&_systemImportTransformerGlobalIdentifier.define.amd?new Promise(function(resolve,reject){_systemImportTransformerGlobalIdentifier.require([_config.default.iconsystemmodule],resolve,reject)}):"undefined"!=typeof module&&module.exports&&"undefined"!=typeof require||"undefined"!=typeof module&&module.component&&_systemImportTransformerGlobalIdentifier.require&&"component"===_systemImportTransformerGlobalIdentifier.require.loader?Promise.resolve(require((_config.default.iconsystemmodule))):Promise.resolve(_systemImportTransformerGlobalIdentifier[_config.default.iconsystemmodule])).then(function(IconSystem){var iconSystem=new IconSystem;prefetchTemplate(iconSystem.getTemplateName());return iconSystem}).then(function(iconSystem){fetchQueue();iconSystem.init()}).catch()},500)},prefetchTemplates=function(templatesNames){templateList=templateList.concat(templatesNames);processQueue()},prefetchTemplate=function(templateName){return prefetchTemplates([templateName])},prefetchStrings=function(component,keys){if(!stringList[component]){stringList[component]=[]}stringList[component]=stringList[component].concat(keys);processQueue()},prefetchString=function(component,key){if(!stringList[component]){stringList[component]=[]}stringList[component].push(key);processQueue()};prefetchTemplates([].concat(["core/loading"],["core/modal"],["core/modal_backdrop"]));prefetchStrings("core",["cancel","closebuttontitle","loading","savechanges"]);prefetchStrings("core_form",["showless","showmore"]);_exports.default={prefetchTemplate:prefetchTemplate,prefetchTemplates:prefetchTemplates,prefetchString:prefetchString,prefetchStrings:prefetchStrings};return _exports.default});
//# sourceMappingURL=prefetch.min.js.map
