define("core/treegrid",["exports","core/local/aria/selectors"],(function(_exports,_selectors){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0,_selectors=(obj=_selectors)&&obj.__esModule?obj:{default:obj};class TreeGrid{static createTreeGrid(treeElement){return new TreeGrid(treeElement)}constructor(treeElement){!function(obj,key,value){key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value}(this,"treeElement",void 0),this.treeElement=treeElement,this.registerEventListeners(),this.initialiseAttributes()}initialiseAttributes(){this.treeElement.querySelectorAll(_selectors.default.elements.focusable).forEach((element=>{element.setAttribute("tabindex","-1")})),Array.from(this.treeElement.querySelectorAll("tr")).reverse().forEach((rowElement=>{rowElement.setAttribute("tabindex","-1")})),this.getFirstRow().setAttribute("tabindex","0")}registerEventListeners(){this.treeElement.addEventListener("keydown",this.handleKeyDown.bind(this)),this.treeElement.addEventListener("click",this.handleClick.bind(this))}handleClick(event){const clickedItem=event.target,focusableParent=clickedItem.closest(_selectors.default.elements.focusable);if(focusableParent)return void focusableParent.focus();const tabbableParent=clickedItem.closest(_selectors.default.elements.tabbable);tabbableParent&&tabbableParent.focus()}handleKeyDown(event){return window.console.log(this),"Enter"===event.key?this.handleKeyEnter(event):"ArrowRight"===event.key?this.handleKeyArrowRight(event):"ArrowLeft"===event.key?this.handleKeyArrowLeft(event):"ArrowUp"===event.key?this.handleKeyArrowUp(event):"ArrowDown"===event.key?this.handleKeyArrowDown(event):"Home"===event.key?event.ctrl?this.handleKeyCtrlHome(event):this.handleKeyHome(event):"End"===event.key?event.ctrl?this.handleKeyCtrlEnd(event):this.handleKeyEnd(event):void 0}handleKeyEnter(event){event.preventDefault()}handleKeyArrowRight(event){const focusedItem=this.getFocusedItem();return"false"===focusedItem.getAttribute("aria-expanded")?(event.preventDefault(),void this.expandRow(focusedItem)):"true"===focusedItem.getAttribute("aria-expanded")?(event.preventDefault(),void this.focusFirstCell(focusedItem)):void(focusedItem.nextElementSibling&&(this.focusNextCell(focusedItem),event.preventDefault()))}handleKeyArrowLeft(event){const focusedItem=this.getFocusedItem();if("true"===focusedItem.getAttribute("aria-expanded"))return event.preventDefault(),void this.collapseRow(focusedItem);if("false"!==focusedItem.getAttribute("aria-expanded")){if(null===focusedItem.previousElementSibling)return this.rowFocusSupported()?(event.preventDefault(),void this.focusRow(focusedItem)):void 0;this.focusPreviousCell(focusedItem),event.preventDefault()}}handleKeyArrowUp(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===focusedItem.previousElementSibling)return;return this.focusRowAbove(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===focusedItem.previousElementSibling)return;this.focusCellAbove(focusedItem),event.preventDefault()}}handleKeyArrowDown(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===focusedItem.nextElementSibling)return;return this.focusRowBelow(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===focusedItem.nextElementSibling)return;this.focusCellBelow(focusedItem),event.preventDefault()}}handleKeyHome(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===focusedItem.previousElementSibling)return;return this.focusFirstRow(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===focusedItem.previousElementSibling)return;this.focusFirstCell(focusedItem),event.preventDefault()}}handleKeyEnd(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===focusedItem.nextElementSibling)return;return this.focusLastRow(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===focusedItem.nextElementSibling)return;this.focusLastCell(focusedItem),event.preventDefault()}}handleKeyControlHome(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===this.getRowForItem(focusedItem).previousElementSibling)return;return this.focusFirstRow(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===this.getRowForItem(focusedItem).previousElementSibling)return;this.focusFirstCellInRow(focusedItem),event.preventDefault()}}handleKeyControlEnd(event){const focusedItem=this.getFocusedItem();if(this.isRow(focusedItem)){if(null===this.getRowForItem(focusedItem).nextElementSibling)return;return this.focusLastRow(focusedItem),void event.preventDefault()}if(this.isCell(focusedItem)){if(null===this.getRowForItem(focusedItem).nextElementSibling)return;this.focusLastCellInRow(focusedItem),event.preventDefault()}}getFocusedItem(){return document.activeElement}getFocusableElements(parent){return Array.from(parent.closest(_selectors.default.elements.focusable))}isRow(item){return item.matches("tr")}isCell(item){return item.closest("td")}focusCell(cell){const focusableChildren=this.getFocusableElements(cell);focus(focusableChildren[0]||cell)}focus(item){item.tabIndex=0,item.focus()}getRowForItem(item){return item.closest("tr")}expandRow(item){item.setAttribute("aria-expanded","true")}collapseRow(item){item.setAttribute("aria-expanded","false")}getCellWithItem(item){return item.closest("td")}getNavigableColumns(row){return Array.from(row.getElementsByTagName("td"))}getFirstRow(){return this.treeElement.querySelector("tr")}getLastRow(){return this.treeElement.querySelector("tr:last-child")}getPreviousRow(item){return this.getRowForItem(item).previousElementSibling}getNextRow(item){return this.getRowForItem(item).nextElementSibling}focusSameCellInRow(currentItem,targetRow){const currentRow=this.getRowForItem(currentItem),currentIndex=this.getNavigableColumns(currentRow).indexOf(this.getCellWithItem(currentItem)),targetCols=this.getNavigableColumns(targetRow);this.focusCell(targetCols[currentIndex])}focusCellAbove(item){this.focusSameCellInRow(item,this.getPreviousRow(item))}focusCellBelow(item){this.focusSameCellInRow(item,this.getNextRow(item))}focusRowAbove(item){this.focus(this.getPreviousRow(item))}focusRowBelow(item){this.focus(this.getNextRow(item))}focusFirstCell(row){this.focus(row.querySelector("td"))}focusLastCell(row){this.focus(row.querySelectorAll("td").pop())}focusFirstCellInRow(item){this.focusFirstCell(this.getRowForItem(item))}focusLastCellInRow(item){this.focusLastCell(this.getRowForItem(item))}focusNextCell(item){this.focus(item.nextElementSibling)}focusPreviousCell(item){focus(item.previousElementSibling)}rowFocusSupported(){return!("focusRows"in this.treeElement.dataset)||this.treeElement.dataset.focusRows}}return _exports.default=TreeGrid,_exports.default}));

//# sourceMappingURL=treegrid.min.js.map