{"version":3,"sources":["../src/itemchooser.js"],"names":["eventName","itemEvents","eventTypes","stateUpdated","eventDispatch","notifyStateUpdated","name","constructor","setMutations","ItemMutations","callerElement","caller","tabName","items","length","item","favourite","isRecommended","tabConfig","Object","assign","titleComponent","visible","validateTabConfiguration","titleIdentifier","title","Error","_modal","_getModal","body","chooserBody","footer","chooserFooter","large","isDialogueLarge","scrollable","isDialogueScrollable","templateContext","chooserTemplateContext","dialogueTitle","type","modalTypes","DEFAULT","then","modal","setupReactiveModal","getRoot","on","ModalEvents","hidden","dispatch","bind","Promise","all","getBodyPromise","chooserData","tabList","initialTab","setInitialState","carousel","id","isActive","map","tabData","data","Carousel","element","querySelector","reactive","TabSelector","TabContainer","querySelectorAll","forEach","Item","getModal","show","hide","itemName","state","get","window","location","href","link","_cachedData","reject","getPopulatedTab","recommendedTab","allItemsTab","favouriteTab","Templates","render","resolve","classes","cachedData","orderedTabList","itemData","visibilityFunction","getTabVisibilityFunction","filterFunction","getTabFilterFunction","filteredItems","concat","filter","some","find","orderedList","tabOrder","value","Reactive"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A module to display items in a chooser format for selection, including help, favouriting, tab organisation, and\n * search.\n *\n * @module     core/itemchooser\n * @copyright  2021 Andrew Lyons <andrew@nicols.co.uk>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport {\n    create as createModal,\n    types as modalTypes,\n} from 'core/modal_factory';\nimport * as Templates from 'core/templates';\nimport {get_string as getString} from 'core/str';\nimport {prefetchStrings} from 'core/prefetch';\n\nimport Carousel from './local/itemchooser/carousel';\nimport Item from './local/itemchooser/item';\nimport TabContainer from './local/itemchooser/tabcontainer';\nimport TabSelector from './local/itemchooser/tabselector';\nimport ItemMutations from './local/itemchooser/mutations';\nimport {Reactive} from 'core/reactive';\nimport * as itemEvents from './local/itemchooser/events';\n\nimport ModalEvents from 'core/modal_events';\n\n// Prefetch the strings.\nprefetchStrings('core', [\n    'all',\n    'favourite',\n    'recommended',\n]);\n\n/**\n * @typedef tabConfig\n * @property {string} name\n * @property {bool} [visible=false]\n */\n\nexport default class extends Reactive {\n    constructor() {\n        super({\n            eventName: itemEvents.eventTypes.stateUpdated,\n            eventDispatch: itemEvents.notifyStateUpdated,\n        });\n\n        this.name = this.constructor.name;\n\n        this.setMutations(new ItemMutations());\n    }\n\n    /**\n     * @property {string} The name of the itemchooser type.\n     */\n    static name = 'itemchooser';\n\n    /**\n     * Store a reference to the element that opened the item chooser.\n     *\n     * @param {HTMLElement} callerElement\n     */\n    setCaller(callerElement) {\n        this.caller = callerElement;\n    }\n\n    /**\n     * Fetch the cached data.\n     *\n     * @returns {Promise<object>}\n     */\n    get cachedData() {\n        if (!this._cachedData) {\n            this._cachedData = this.data;\n        }\n\n        return this._cachedData;\n    }\n\n    /**\n     * Fetch the data to display.\n     *\n     * @returns {Promise<object>}\n     */\n    get data() {\n        return Promise.reject(new Error(`TODO: Implement`));\n    }\n\n    /**\n     * Get the tab order.\n     *\n     * @returns {string[]}\n     */\n    get tabOrder() {\n        // Favourites, All.\n        return [\n            'recommendedTab',\n            'favouriteTab',\n            'allItemsTab',\n        ];\n    }\n\n    /**\n     * Get an ordered list of tabs for this chooser.\n     *\n     * To be extended by the child class.\n     *\n     * @returns {Promise<tabConfig[]>}\n     */\n    get tabList() {\n        return Promise.all([\n            this.getPopulatedTab(this.recommendedTab),\n            this.getPopulatedTab(this.allItemsTab),\n            this.getPopulatedTab(this.favouriteTab,),\n        ]).then(([recommendedTab, allItemsTab, favouriteTab]) => {\n            return {\n                recommendedTab,\n                allItemsTab,\n                favouriteTab,\n            };\n        });\n    }\n\n    /**\n     * Get the tab visibility controller function for the named tab.\n     *\n     * @param {string} tabName\n     * @return {function|null}\n     */\n    getTabVisibilityFunction(tabName) {\n        switch (tabName) {\n            case 'favourites':\n            case 'recommended':\n                return ({items}) => !!items.length;\n            default:\n                return null;\n        }\n    }\n\n    /**\n     * Get the tab visibility controller function for the named tab.\n     *\n     * @param {string} tabName\n     * @return {function|null}\n     */\n    getTabFilterFunction(tabName) {\n        switch (tabName) {\n            case 'favourites':\n                return item => item.favourite;\n            case 'recommended':\n                return item => item.isRecommended;\n            default:\n                return null;\n        }\n    }\n\n    /**\n     * Get the data for the recommended items tab.\n     *\n     * @returns {tabConfig}\n     */\n    get recommendedTab() {\n        return {\n            name: 'recommended',\n            titleIdentifier: 'recommended',\n        };\n    }\n\n    /**\n     * Get the data for the all items tab.\n     *\n     * @returns {tabConfig}\n     */\n    get allItemsTab() {\n        return {\n            name: 'all',\n            visible: true,\n            titleIdentifier: 'all',\n        };\n    }\n\n    /**\n     * Get the data for the favourite items tab.\n     *\n     * @returns {tabConfig}\n     */\n    get favouriteTab() {\n        return {\n            name: 'favourites',\n            titleIdentifier: 'favourites',\n        };\n    }\n\n    /**\n     * Get the populated tab data for the given configuration.\n     *\n     * @param {tabConfig} tabConfig\n     * @returns {Promise<tabConfig>}\n     */\n    async getPopulatedTab(tabConfig) {\n        tabConfig = Object.assign({\n            titleComponent: 'core',\n            visible: false,\n        }, tabConfig);\n\n        this.validateTabConfiguration(tabConfig);\n\n        tabConfig.title = await getString(tabConfig.titleIdentifier, tabConfig.titleComponent);\n\n        return tabConfig;\n    }\n\n    /**\n     * Validate the tab configuration to check for required values.\n     *\n     * @param {tabConfig} tabConfig\n     * @throws {Error}\n     */\n    validateTabConfiguration(tabConfig) {\n        if (!tabConfig.name) {\n            throw new Error(`Missing name for tab`, tabConfig);\n        }\n\n        if (!tabConfig.titleIdentifier || !tabConfig.titleComponent) {\n            throw new Error(`Missing title details for ${tabConfig.name}`);\n        }\n    }\n\n    /**\n     * Get the template to use for the body.\n     *\n     * @returns {string} The template name\n     */\n    get templateName() {\n        return 'core/local/itemchooser/body';\n    }\n\n    /**\n     * Get the modal.\n     *\n     * @returns {Promise}\n     */\n    getModal() {\n        if (!this._modal) {\n            this._modal = this._getModal();\n        }\n\n        return this._modal;\n    }\n\n    _getModal() {\n        return createModal({\n            body: this.chooserBody,\n            footer: this.chooserFooter,\n            large: this.isDialogueLarge,\n            scrollable: this.isDialogueScrollable,\n            templateContext: this.chooserTemplateContext,\n            title: this.dialogueTitle,\n            type: modalTypes.DEFAULT,\n        })\n        .then(modal => this.setupReactiveModal(modal))\n        .then(modal => {\n            modal.getRoot().on(ModalEvents.hidden, function() {\n                this.dispatch('itemChooserHidden');\n            }.bind(this));\n            return modal;\n        });\n    }\n\n    setupReactiveModal(modal) {\n        return Promise.all([\n            modal,\n            modal.getBodyPromise(),\n            this.chooserData,\n        ])\n        .then(([modal, body, {items, tabList, initialTab}]) => {\n            this.setInitialState({\n                carousel: [\n                    {\n                        id: 'items',\n                        isActive: true,\n                    },\n                    {\n                        id: 'help',\n                        isActive: false,\n                    },\n                ],\n                items: items.map(item => {\n                    return {\n                        ...item,\n                        id: item.name,\n                    };\n                }),\n                tabData: tabList.map(data => {\n                    return {\n                        ...data,\n                        id: data.name,\n                    };\n                })\n            });\n\n            new Carousel({\n                element: body[0].querySelector('[data-region=\"carousel\"]'),\n                reactive: this,\n            });\n\n            new TabSelector({\n                element: body[0].querySelector('[role=\"tablist\"]'),\n                reactive: this,\n            });\n\n            // Set up the tab container, which contains the list of items.\n            new TabContainer({\n                element: body[0].querySelector('.tab-content'),\n                reactive: this,\n            });\n\n            body[0].querySelectorAll('[role=\"menuitem\"]').forEach(element => new Item({element}));\n\n            // Set the name of the initial tab.\n            this.dispatch('selectTab', this, initialTab.name);\n\n            return modal;\n        });\n    }\n\n    /**\n     * Get the title for the item chooser dialogue.\n     *\n     * @returns {Promise<string>}\n     */\n    get dialogueTitle() {\n        return Promise.reject(new Error(`TODO: Implement the title fetcher`));\n    }\n\n    /**\n     * Get the Chooser body.\n     *\n     * @returns {Promise<string>}\n     */\n    get chooserBody() {\n        return this.chooserData.then(chooserData => Templates.render(\n            'core/itemchooser',\n            chooserData\n        ));\n    }\n\n    /**\n     * Get the Chooser footer.\n     *\n     * @returns {Promise<string>}\n     */\n    get chooserFooter() {\n        return Promise.resolve();\n    }\n\n    /**\n     * Whether to make the dialogue large.\n     *\n     * @returns {boolean}\n     */\n    isDialogueLarge() {\n        return true;\n    }\n\n    /**\n     * Whether to make the dialogue scrollable.\n     *\n     * @returns {boolean}\n     */\n    isDialogueScrollable() {\n        return false;\n    }\n\n    /**\n     * Get any context data for the dialogue.\n     *\n     * @returns {object}\n     */\n    get chooserTemplateContext() {\n        return {\n            classes: 'modchooser',\n        };\n    }\n\n    /**\n     * Format the data for the item chooser.\n     *\n     * @returns {object}\n     */\n    get chooserData() {\n        return Promise.all([this.cachedData, this.orderedTabList])\n        .then(([itemData, tabList]) => {\n            // Set initial tab visibility state.\n            tabList = tabList.map(tabConfig => {\n                const visibilityFunction = this.getTabVisibilityFunction(tabConfig.name);\n                if (!visibilityFunction) {\n                    return tabConfig;\n                }\n\n                const filterFunction = this.getTabFilterFunction(tabConfig.name);\n                let filteredItems = itemData.concat();\n                filteredItems = filteredItems.filter(itemData => {\n                    if (filterFunction) {\n                        return filterFunction(itemData);\n                    }\n\n                    return true;\n                });\n\n                let visible = tabConfig.visible;\n                if (visibilityFunction) {\n                    visible = visibilityFunction({\n                        tabConfig,\n                        items: filteredItems,\n                    });\n                }\n\n                return Object.assign({}, tabConfig, {\n                    visible,\n                });\n            });\n\n\n            // Set initial tab configuration.\n            if (!tabList.some(tabData => tabData.isActive && tabData.visible)) {\n                tabList.find(tabData => tabData.visible).isActive = true;\n            }\n\n            // Unset the isActive so that it will be changed by the reactive component.\n            const initialTab = tabList.find(tabData => tabData.isActive);\n            initialTab.isActive = false;\n\n            return {\n                items: itemData,\n                tabList,\n                initialTab,\n            };\n        });\n    }\n\n    /**\n     * Get the tabs, in their ordered list.\n     *\n     * @returns {Promise}\n     */\n    get orderedTabList() {\n        return this.tabList.then(tabList => {\n            const orderedList = this.tabOrder.map(tabName => {\n                return tabList[tabName] ?? false;\n            }).filter(value => value);\n\n            return orderedList;\n        });\n    }\n\n    /**\n     * Display the modal.\n     */\n    async show() {\n        const modal = await this.getModal();\n        modal.show();\n    }\n\n    /**\n     * Hide the modal.\n     */\n    async hide() {\n        const modal = await this.getModal();\n        modal.hide();\n        this.reactive.dispatch('setPanel', 'items');\n    }\n\n    /**\n     * Handle selection of the item.\n     *\n     * @param {string} itemName\n     */\n    handleItemSelection(itemName) {\n        const item = this.state.items.get(itemName);\n        window.location.href = item.link;\n    }\n}\n"],"file":"itemchooser.min.js"}