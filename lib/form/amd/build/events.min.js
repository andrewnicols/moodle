define ("core_form/events",["exports","core/str","core/event_dispatcher","jquery","core/yui"],function(_exports,_str,_event_dispatcher,_jquery,_yui){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.types=_exports.triggerUploadStarted=_exports.triggerUploadCompleted=_exports.notifyUploadStarted=_exports.notifyUploadCompleted=_exports.notifyUploadChanged=_exports.notifyFormSubmittedByJavascript=_exports.notifyFormError=_exports.notifyFieldValidationFailure=_exports.eventTypes=void 0;_jquery=_interopRequireDefault(_jquery);_yui=_interopRequireDefault(_yui);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var changesMadeString;(0,_str.get_string)("changesmadereallygoaway","moodle").then(function(string){changesMadeString=string;return string}).catch();var changesMadeCheck=function(e){if(e){e.returnValue=changesMadeString}},eventTypes={formError:"core_form/error",formSubmittedByJavascript:"core_form/submittedByJavascript",formFieldValidationFailed:"core_form/fieldValidationFailed",uploadStarted:"core_form/uploadStarted",uploadCompleted:"core_form/uploadCompleted",uploadChanged:"core_form/uploadChanged"};_exports.eventTypes=eventTypes;_exports.notifyFormError=function notifyFormError(field){return(0,_event_dispatcher.dispatchEvent)(eventTypes.formError,{},field)};_exports.notifyFormSubmittedByJavascript=function notifyFormSubmittedByJavascript(form){var skipValidation=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!1,fallbackHandled=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!1;if(skipValidation){window.skipClientValidation=!0}var customEvent=(0,_event_dispatcher.dispatchEvent)(eventTypes.formSubmittedByJavascript,{skipValidation:skipValidation,fallbackHandled:fallbackHandled},form);if(skipValidation){window.skipClientValidation=!1}return customEvent};_exports.notifyFieldValidationFailure=function notifyFieldValidationFailure(field,message){return(0,_event_dispatcher.dispatchEvent)(eventTypes.formFieldValidationFailed,{message:message},field,{cancelable:!0})};var notifyUploadStarted=function(elementId){window.addEventListener("beforeunload",changesMadeCheck);return(0,_event_dispatcher.dispatchEvent)(eventTypes.uploadStarted,{},document.getElementById(elementId),{bubbles:!0,cancellable:!1})};_exports.notifyUploadStarted=notifyUploadStarted;var notifyUploadCompleted=function(elementId){window.removeEventListener("beforeunload",changesMadeCheck);return(0,_event_dispatcher.dispatchEvent)(eventTypes.uploadCompleted,{},document.getElementById(elementId),{bubbles:!0,cancellable:!1})};_exports.notifyUploadCompleted=notifyUploadCompleted;_exports.triggerUploadStarted=notifyUploadStarted;_exports.triggerUploadCompleted=notifyUploadCompleted;_exports.types={uploadStarted:"core_form/uploadStarted",uploadCompleted:"core_form/uploadCompleted"};var legacyEventsRegistered=!1;if(!legacyEventsRegistered){_yui.default.use("event","moodle-core-event",function(){document.addEventListener(eventTypes.formError,function(e){var element=_yui.default.one(e.target),formElement=_yui.default.one(e.target.closest("form"));_yui.default.Global.fire(M.core.globalEvents.FORM_ERROR,{formid:formElement.generateID(),elementid:element.generateID()})});document.addEventListener(eventTypes.formSubmittedByJavascript,function(e){if(e.detail.fallbackHandled){return}if(e.skipValidation){window.skipClientValidation=!0}var form=_yui.default.one(e.target);form.fire(M.core.event.FORM_SUBMIT_AJAX,{currentTarget:form,fallbackHandled:!0});if(e.skipValidation){window.skipClientValidation=!1}})});document.addEventListener(eventTypes.formFieldValidationFailed,function(e){var legacyEvent=_jquery.default.Event("core_form-field-validation");(0,_jquery.default)(e.target).trigger(legacyEvent,e.detail.message)});legacyEventsRegistered=!0}_exports.notifyUploadChanged=function notifyUploadChanged(elementId){return(0,_event_dispatcher.dispatchEvent)(eventTypes.uploadChanged,{},document.getElementById(elementId),{bubbles:!0,cancellable:!1})}});
//# sourceMappingURL=events.min.js.map
