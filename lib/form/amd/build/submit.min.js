define ("core_form/submit",["exports","core_form/events"],function(_exports,_events){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.init=void 0;var cookieListener=0,cookieListeningButtons=[],listenForDownloadCookie=function(button){cookieListeningButtons.push(button);if(!cookieListener){cookieListener=setInterval(function(){var parts=document.cookie.split(getCookieName()+"=");if(2==parts.length){clearDownloadCookie();clearInterval(cookieListener);cookieListener=0;cookieListeningButtons.forEach(function(button){button.disabled=!1})}},500)}},getCookieName=function(){return"moodledownload_"+M.cfg.sesskey},clearDownloadCookie=function(){document.cookie=encodeURIComponent(getCookieName())+"=deleted; expires="+new Date(0).toUTCString()};_exports.init=function init(elementId){var button=document.getElementById(elementId);document.addEventListener(_events.formEventTypes.uploadStarted,function(e){window.console.log(e.target);button.disabled=!0});document.addEventListener(_events.formEventTypes.uploadCompleted,function(e){window.console.log(e.target);button.disabled=!1});if("off"===button.form.dataset.doubleSubmitProtection){return}button.form.addEventListener("submit",function(event){var disableAction=function(){if(event.defaultPrevented||button.disabled){return}button.disabled=!0;clearDownloadCookie();listenForDownloadCookie(button)};window.addEventListener("beforeunload",disableAction);setTimeout(function(){window.removeEventListener("beforeunload",disableAction)},0)},!1)}});
//# sourceMappingURL=submit.min.js.map
