define ("core_calendar/calendar_filter",["jquery","core_calendar/selectors","core_calendar/events","core/str","core/templates"],function($,CalendarSelectors,CalendarEvents,Str,Templates){var registerEventListeners=function(root){root.on("click",CalendarSelectors.eventFilterItem,function(e){var target=$(e.currentTarget);toggleFilter(target);e.preventDefault()});$("body").on(CalendarEvents.viewUpdated,function(){var filters=root.find(CalendarSelectors.eventFilterItem);filters.each(function(i,filter){filter=$(filter);if(filter.data("eventtype-hidden")){var data=getFilterData(filter);fireFilterChangedEvent(data)}})})},toggleFilter=function(target){var data=getFilterData(target);data.hidden=!data.hidden;M.util.js_pending("core_calendar/calendar_filter:toggleFilter");return Str.get_string("eventtype"+data.eventtype,"calendar").then(function(nameStr){data.name=nameStr;data.icon=!0;data.key="i/"+data.eventtype+"event";data.component="core";return data}).then(function(context){return Templates.render("core_calendar/event_filter_key",context)}).then(function(html,js){return Templates.replaceNode(target,html,js)}).then(function(){fireFilterChangedEvent(data);M.util.js_complete("core_calendar/calendar_filter:toggleFilter")})},fireFilterChangedEvent=function(data){M.util.js_pending("month-mini-filterChanged");$("body").trigger(CalendarEvents.filterChanged,{type:data.eventtype,hidden:data.hidden});M.util.js_complete("month-mini-filterChanged")},getFilterData=function(target){return{eventtype:target.data("eventtype"),hidden:target.data("eventtype-hidden")}};return{init:function(root){root=$(root);registerEventListeners(root)}}});
//# sourceMappingURL=calendar_filter.min.js.map
