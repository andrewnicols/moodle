define ("core_message/message_drawer_view_group_info",["jquery","core/str","core/templates","core_message/message_repository","core_message/message_drawer_lazy_load_list"],function($,Str,Templates,Repository,LazyLoadList){var SELECTORS={CONTENT_CONTAINER:"[data-region=\"group-info-content-container\"]",MEMBERS_LIST:"[data-region=\"members-list\"]"},TEMPLATES={CONTENT:"core_message/message_drawer_view_group_info_body_content",MEMBERS_LIST:"core_message/message_drawer_view_group_info_participants_list"},getContentContainer=function(root){return root.find(SELECTORS.CONTENT_CONTAINER)},render=function(root,conversation,loggedInUserId){var placeholderCount=50<conversation.totalMemberCount?50:conversation.totalMemberCount,placeholders=Array.apply(null,Array(placeholderCount)).map(function(){return!0}),templateContext={name:conversation.name,subname:conversation.subname,imageurl:conversation.imageUrl,placeholders:placeholders,loggedinuser:{id:loggedInUserId}};return Templates.render(TEMPLATES.CONTENT,templateContext).then(function(html){getContentContainer(root).append(html);return html})},getLoadMembersCallback=function(conversation,limit,offset){return function(root,userId){return Repository.getConversationMembers(conversation.id,userId,limit+1,offset).then(function(members){if(members.length>limit){members=members.slice(0,-1)}else{LazyLoadList.setLoadedAll(root,!0)}offset=offset+limit;return members.filter(function(member){return member.id!=userId})})}},renderMembersCallback=function(contentContainer,members){return Templates.render(TEMPLATES.MEMBERS_LIST,{contacts:members}).then(function(html){contentContainer.append(html);return html})};return{show:function show(namespace,header,body,footer,conversation,loggedInUserId){var root=$(body);getContentContainer(root).empty();return render(root,conversation,loggedInUserId).then(function(){var listRoot=LazyLoadList.getRoot(root);LazyLoadList.show(listRoot,getLoadMembersCallback(conversation,50,0),renderMembersCallback)})},description:function description(root,conversation){return Str.get_string("messagedrawerviewgroupinfo","core_message",conversation.name)}}});
//# sourceMappingURL=message_drawer_view_group_info.min.js.map
