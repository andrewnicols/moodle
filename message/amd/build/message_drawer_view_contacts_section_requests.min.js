define ("core_message/message_drawer_view_contacts_section_requests",["jquery","core/notification","core/pubsub","core/templates","core_message/message_repository","core_message/message_drawer_events","core_message/message_drawer_lazy_load_list"],function($,Notification,PubSub,Templates,MessageRepository,MessageDrawerEvents,LazyLoadList){var SELECTORS={CONTACT_REQUEST:"[data-region=\"contact-request\"]"},TEMPLATES={REQUESTS_LIST:"core_message/message_drawer_view_contacts_body_section_requests_list"},render=function(contentContainer,requests){var formattedRequests=requests.map(function(request){return{id:request.id,profileimageurl:request.profileimageurl,fullname:request.fullname}});return Templates.render(TEMPLATES.REQUESTS_LIST,{requests:formattedRequests}).then(function(html){contentContainer.append(html);return html}).catch(Notification.exception)},load=function(listRoot,userId){return MessageRepository.getContactRequests(userId).then(function(requests){LazyLoadList.setLoadedAll(listRoot,!0);return requests}).catch(Notification.exception)},handleContactRequestProcessed=function(root){return function(request){root.find("[data-request-id=\""+request.userid+"\"]").remove();var contactRequests=root.find(SELECTORS.CONTACT_REQUEST);if(!contactRequests.length){LazyLoadList.showEmptyMessage(root);LazyLoadList.hideContent(root)}}},registerEventListeners=function(root){PubSub.subscribe(MessageDrawerEvents.CONTACT_REQUEST_ACCEPTED,handleContactRequestProcessed(root));PubSub.subscribe(MessageDrawerEvents.CONTACT_REQUEST_DECLINED,handleContactRequestProcessed(root))};return{show:function(root){if(!root.attr("data-contacts-init")){registerEventListeners(root);root.attr("data-contacts-init",!0)}LazyLoadList.show(root,load,render)}}});
//# sourceMappingURL=message_drawer_view_contacts_section_requests.min.js.map
