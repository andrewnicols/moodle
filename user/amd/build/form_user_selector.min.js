define ("core_user/form_user_selector",["exports","core/ajax","core/templates","core/str"],function(_exports,_ajax,_templates,_str){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.processResults=function(selector,results){if(!Array.isArray(results)){return results}else{return results.map(function(result){return{value:result.id,label:result.label}})}};_exports.transport=transport;_ajax=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_ajax);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{Promise.resolve(value).then(_next,_throw)}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)})}}function transport(){return _transport.apply(this,arguments)}function _transport(){_transport=_asyncToGenerator(regeneratorRuntime.mark(function _callee(selector,query,callback,failure){var request,response,msg,labels;return regeneratorRuntime.wrap(function(_context){while(1){switch(_context.prev=_context.next){case 0:request={methodname:"core_user_search_identity",args:{query:query}};_context.prev=1;_context.next=4;return _ajax.default.call([request])[0];case 4:response=_context.sent;if(!response.overflow){_context.next=12;break}_context.next=8;return(0,_str.get_string)("toomanyuserstoshow","core",">"+response.maxusersperpage);case 8:msg=_context.sent;callback(msg);_context.next=19;break;case 12:labels=[];response.list.forEach(function(user){labels.push((0,_templates.render)("core_user/form_user_selector_suggestion",user))});_context.next=16;return Promise.all(labels);case 16:labels=_context.sent;response.list.forEach(function(user,index){user.label=labels[index]});callback(response.list);case 19:_context.next=24;break;case 21:_context.prev=21;_context.t0=_context["catch"](1);failure(_context.t0);case 24:case"end":return _context.stop();}}},_callee,null,[[1,21]])}));return _transport.apply(this,arguments)}});
//# sourceMappingURL=form_user_selector.min.js.map
