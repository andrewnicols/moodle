define ("report_insights/actions",["jquery","core/str","core/ajax","core/notification","core/url","core/modal_factory","core/modal_events"],function($,Str,Ajax,Notification,Url,ModalFactory,ModalEvents){return{initBulk:function(rootNode){var executeAction=function(predictionIds,predictionContainers,actionName){return Ajax.call([{methodname:"report_insights_action_executed",args:{predictionids:predictionIds,actionname:actionName}}])[0].then(function(){var tableNode=!1;predictionContainers.forEach(function(el){if(!1===tableNode){tableNode=el.closest("table")}el.remove()});if(0===tableNode.find("tbody > tr").length){let params={contextid:tableNode.closest("div.insight-container").data("context-id"),modelid:tableNode.closest("div.insight-container").data("model-id")};window.location.assign(Url.relativeUrl("report/insights/insights.php",params,!1))}}).catch(Notification.exception)};$(rootNode+" [data-bulk-actionname]").on("click",function(e){e.preventDefault();var action=$(e.currentTarget),actionName=action.data("bulk-actionname"),actionVisibleName=action.text().trim(),predictionIds=[],predictionContainers=[];$(".insights-list input[data-togglegroup^=\"insight-bulk-action-\"][data-toggle=\"slave\"]:checked").each(function(){var container=$(this).closest("tr[data-prediction-id]");predictionContainers.push(container);predictionIds.push(container.data("prediction-id"))});if(0===predictionIds.length){return this}var strings=[];Str.get_strings([{key:"confirmbulkaction",component:"report_insights",param:{action:actionVisibleName,nitems:predictionIds.length}},{key:"confirm",component:"moodle"}]).then(function(strs){strings=strs;return ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:actionVisibleName,body:strings[0]})}).then(function(modal){modal.setSaveButtonText(strings[1]);modal.show();modal.getRoot().on(ModalEvents.save,function(){return executeAction(predictionIds,predictionContainers,actionName)});return modal}).catch(Notification.exception);return this})}}});
//# sourceMappingURL=actions.min.js.map
