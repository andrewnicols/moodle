define ("core_courseformat/local/courseindex/section",["exports","core_courseformat/local/courseindex/sectiontitle","core_courseformat/local/courseeditor/dndsection"],function(_exports,_sectiontitle,_dndsection){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_sectiontitle=_interopRequireDefault(_sectiontitle);_dndsection=_interopRequireDefault(_dndsection);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}class Component extends _dndsection.default{create(){this.name="courseindex_section";this.selectors={SECTION_ITEM:"[data-for='section_item']",SECTION_TITLE:"[data-for='section_title']",CM_LAST:"[data-for=\"cm\"]:last-child"};this.classes={SECTIONHIDDEN:"dimmed",SECTIONCURRENT:"current",LOCKED:"editinprogress",RESTRICTIONS:"rectrictions",PAGEITEM:"pageitem"};this.id=this.element.dataset.id;this.isPageItem=!1}static init(target,selectors){return new Component({element:document.getElementById(target),selectors})}stateReady(state){this.configState(state);const sectionItem=this.getElement(this.selectors.SECTION_ITEM);if(this.reactive.isEditing&&this.reactive.supportComponents){const titleitem=new _sectiontitle.default({...this,element:sectionItem,fullregion:this.element});this.configDragDrop(titleitem)}const section=state.section.get(this.id);if(window.location.href==section.sectionurl.replace(/&amp;/g,"&")){this.reactive.dispatch("setPageItem","section",this.id);sectionItem.scrollIntoView()}}getWatchers(){return[{watch:"section[".concat(this.id,"]:deleted"),handler:this.remove},{watch:"section[".concat(this.id,"]:updated"),handler:this._refreshSection},{watch:"course.pageItem:updated",handler:this._refreshPageItem}]}getLastCm(){return this.getElement(this.selectors.CM_LAST)}_refreshSection(_ref){var _element$dragging,_element$locked,_element$hasrestricti;let{element}=_ref;const sectionItem=this.getElement(this.selectors.SECTION_ITEM);sectionItem.classList.toggle(this.classes.SECTIONHIDDEN,!element.visible);this.element.classList.toggle(this.classes.SECTIONCURRENT,element.current);this.element.classList.toggle(this.classes.DRAGGING,null!==(_element$dragging=element.dragging)&&void 0!==_element$dragging?_element$dragging:!1);this.element.classList.toggle(this.classes.LOCKED,null!==(_element$locked=element.locked)&&void 0!==_element$locked?_element$locked:!1);this.element.classList.toggle(this.classes.RESTRICTIONS,null!==(_element$hasrestricti=element.hasrestrictions)&&void 0!==_element$hasrestricti?_element$hasrestricti:!1);this.locked=element.locked;this.getElement(this.selectors.SECTION_TITLE).innerHTML=element.title}_refreshPageItem(_ref2){var _element$pageItem,_this$pageItem;let{element,state}=_ref2;if(!element.pageItem){return}if(element.pageItem.sectionId!==this.id&&this.isPageItem){this.pageItem=!1;this.getElement(this.selectors.SECTION_ITEM).classList.remove(this.classes.PAGEITEM);return}const section=state.section.get(this.id);if(section.indexcollapsed&&!(null!==(_element$pageItem=element.pageItem)&&void 0!==_element$pageItem&&_element$pageItem.isStatic)){var _element$pageItem2;this.pageItem=(null===(_element$pageItem2=element.pageItem)||void 0===_element$pageItem2?void 0:_element$pageItem2.sectionId)==this.id}else{this.pageItem="section"==element.pageItem.type&&element.pageItem.id==this.id}const sectionItem=this.getElement(this.selectors.SECTION_ITEM);sectionItem.classList.toggle(this.classes.PAGEITEM,null!==(_this$pageItem=this.pageItem)&&void 0!==_this$pageItem?_this$pageItem:!1);if(this.pageItem&&!this.reactive.isEditing){this.element.scrollIntoView({block:"nearest"})}}}_exports.default=Component;return _exports.default});
//# sourceMappingURL=section.min.js.map
