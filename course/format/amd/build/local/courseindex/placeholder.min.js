define ("core_courseformat/local/courseindex/placeholder",["exports","core/reactive","core/templates","core_courseformat/courseeditor","core/pending"],function(_exports,_reactive,_templates,_courseeditor,_pending){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_templates=_interopRequireDefault(_templates);_pending=_interopRequireDefault(_pending);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}class Component extends _reactive.BaseComponent{static init(target,selectors){return new Component({element:document.getElementById(target),reactive:(0,_courseeditor.getCurrentCourseEditor)(),selectors})}create(){this.pendingContent=new _pending.default("core_courseformat/placeholder:loadcourseindex")}async stateReady(state){if(!this.loadStaticContent()){await this.loadTemplateContent(state)}}loadStaticContent(){const index=this.reactive.getStorageValue("courseIndex");if(index.html&&index.js){_templates.default.replaceNode(this.element,index.html,index.js);this.pendingContent.resolve();return!0}return!1}async loadTemplateContent(state){const exporter=this.reactive.getExporter(),data=exporter.course(state);try{const{html,js}=await _templates.default.renderForPromise("core_courseformat/local/courseindex/courseindex",data);_templates.default.replaceNode(this.element,html,js);this.pendingContent.resolve();this.reactive.setStorageValue("courseIndex",{html,js})}catch(error){this.pendingContent.resolve(error);throw error}}}_exports.default=Component;return _exports.default});
//# sourceMappingURL=placeholder.min.js.map
