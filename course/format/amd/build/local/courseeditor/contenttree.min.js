define ("core_courseformat/local/courseeditor/contenttree",["exports","jquery","core/tree","core/normalise"],function(_exports,_jquery,_tree,_normalise){"use strict";Object.defineProperty(_exports,"__esModule",{value:!0});_exports.default=void 0;_jquery=_interopRequireDefault(_jquery);_tree=_interopRequireDefault(_tree);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}class _default extends _tree.default{constructor(mainElement,selectors,preventcache){var _selectors$ENTER;super(mainElement);this.selectors={SECTION:selectors.SECTION,TOGGLER:selectors.TOGGLER,COLLAPSE:selectors.COLLAPSE,ENTER:null!==(_selectors$ENTER=selectors.ENTER)&&void 0!==_selectors$ENTER?_selectors$ENTER:selectors.TOGGLER};if(preventcache){this._getVisibleItems=this.getVisibleItems;this.getVisibleItems=()=>{this.refreshVisibleItemsCache();return this._getVisibleItems()}}this.treeRoot.on("hidden.bs.collapse shown.bs.collapse",()=>{this.refreshVisibleItemsCache()});this.registerEnterCallback(this.enterCallback.bind(this))}getActiveItem(){const activeItem=this.treeRoot.data("activeItem");if(activeItem){return(0,_normalise.getList)(activeItem)[0]}}enterCallback(jQueryItem){const item=(0,_normalise.getList)(jQueryItem)[0];if(this.isGroupItem(jQueryItem)){const enter=item.querySelector(this.selectors.ENTER);if("#"!==enter.getAttribute("href")){window.location.href=enter.getAttribute("href")}enter.click()}else{const link=item.querySelector("a");if("#"!==link.getAttribute("href")){window.location.href=link.getAttribute("href")}else{link.click()}}}isGroupCollapsed(jQueryItem){const item=(0,_normalise.getList)(jQueryItem)[0],toggler=item.querySelector("[aria-expanded]");return"false"===toggler.getAttribute("aria-expanded")}toggleGroup(item){var _toggler$data;const toggler=item.find(this.selectors.COLLAPSE);let collapsibleId=null!==(_toggler$data=toggler.data("target"))&&void 0!==_toggler$data?_toggler$data:toggler.attr("href");if(!collapsibleId){return}collapsibleId=collapsibleId.replace("#","");const collapsible=(0,_jquery.default)("#".concat(collapsibleId));if(collapsible.length){(0,_jquery.default)("#".concat(collapsibleId)).collapse("toggle")}}expandGroup(item){if(this.isGroupCollapsed(item)){this.toggleGroup(item)}}collapseGroup(item){if(!this.isGroupCollapsed(item)){this.toggleGroup(item)}}expandAllGroups(){const togglers=(0,_normalise.getList)(this.treeRoot)[0].querySelectorAll(this.selectors.SECTION);togglers.forEach(item=>{this.expandGroup((0,_jquery.default)(item))})}}_exports.default=_default;return _exports.default});
//# sourceMappingURL=contenttree.min.js.map
