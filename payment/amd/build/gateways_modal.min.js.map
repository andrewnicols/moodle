{"version":3,"file":"gateways_modal.min.js","sources":["../src/gateways_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Contain the logic for the gateways modal.\n *\n * @module     core_payment/gateways_modal\n * @copyright  2019 Shamim Rezaie <shamim@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport ModalFactory from 'core/modal_factory';\nimport Templates from 'core/templates';\nimport {get_string as getString} from 'core/str';\nimport {getAvailableGateways} from './repository';\nimport Selectors from './selectors';\nimport ModalEvents from 'core/modal_events';\nimport PaymentEvents from 'core_payment/events';\nimport {add as addToast, addToastRegion} from 'core/toast';\nimport Notification from 'core/notification';\nimport ModalGateways from './modal_gateways';\n\n/**\n * Register event listeners for the module.\n */\nconst registerEventListeners = () => {\n    document.addEventListener('click', e => {\n        const gatewayTrigger = e.target.closest('[data-action=\"core_payment/triggerPayment\"]');\n        if (gatewayTrigger) {\n            e.preventDefault();\n\n            show(gatewayTrigger, {focusOnClose: e.target});\n        }\n    });\n};\n\n/**\n * Shows the gateway selector modal.\n *\n * @param {HTMLElement} rootNode\n * @param {Object} options - Additional options\n * @param {HTMLElement} options.focusOnClose The element to focus on when the modal is closed.\n */\nconst show = async(rootNode, {\n    focusOnClose = null,\n} = {}) => {\n    const modal = await ModalFactory.create({\n        type: ModalGateways.TYPE,\n        title: await getString('selectpaymenttype', 'core_payment'),\n        body: await Templates.render('core_payment/gateways_modal', {}),\n    });\n\n    const rootElement = modal.getRoot()[0];\n    addToastRegion(rootElement);\n\n    modal.show();\n\n    modal.getRoot().on(ModalEvents.hidden, () => {\n        // Destroy when hidden.\n        modal.destroy();\n        try {\n            focusOnClose.focus();\n        } catch (e) {\n            // eslint-disable-line\n        }\n    });\n\n    modal.getRoot().on(PaymentEvents.proceed, (e) => {\n        const gateway = (rootElement.querySelector(Selectors.values.gateway) || {value: ''}).value;\n\n        if (gateway) {\n            processPayment(\n                gateway,\n                rootNode.dataset.component,\n                rootNode.dataset.paymentarea,\n                rootNode.dataset.itemid,\n                rootNode.dataset.description\n            )\n            .then(message => {\n                modal.hide();\n                Notification.addNotification({\n                    message: message,\n                    type: 'success',\n                });\n                location.href = rootNode.dataset.successurl;\n\n                // The following return statement is never reached. It is put here just to make eslint happy.\n                return message;\n            })\n            .catch(message => Notification.alert('', message));\n        } else {\n            // We cannot use await in the following line.\n            // The reason is that we are preventing the default action of the save event being triggered,\n            // therefore we cannot define the event handler function asynchronous.\n            getString('nogatewayselected', 'core_payment').then(message => addToast(message)).catch();\n        }\n\n        e.preventDefault();\n    });\n\n    // Re-calculate the cost when gateway is changed.\n    rootElement.addEventListener('change', e => {\n        if (e.target.matches(Selectors.elements.gateways)) {\n            updateCostRegion(rootElement, rootNode.dataset.cost);\n        }\n    });\n\n    const gateways = await getAvailableGateways(rootNode.dataset.component, rootNode.dataset.paymentarea, rootNode.dataset.itemid);\n    const context = {\n        gateways\n    };\n\n    const {html, js} = await Templates.renderForPromise('core_payment/gateways', context);\n    Templates.replaceNodeContents(rootElement.querySelector(Selectors.regions.gatewaysContainer), html, js);\n    selectSingleGateway(rootElement);\n    await updateCostRegion(rootElement, rootNode.dataset.cost);\n};\n\n/**\n * Auto-select the gateway if there is only one gateway.\n *\n * @param {HTMLElement} root An HTMLElement that contains the cost region\n */\nconst selectSingleGateway = root => {\n    const gateways = root.querySelectorAll(Selectors.elements.gateways);\n\n    if (gateways.length == 1) {\n        gateways[0].checked = true;\n    }\n};\n\n/**\n * Shows the cost of the item the user is purchasing in the cost region.\n *\n * @param {HTMLElement} root An HTMLElement that contains the cost region\n * @param {string} defaultCost The default cost that is going to be displayed if no gateway is selected\n * @returns {Promise<void>}\n */\nconst updateCostRegion = async(root, defaultCost = '') => {\n    const gatewayElement = root.querySelector(Selectors.values.gateway);\n    const surcharge = parseInt((gatewayElement || {dataset: {surcharge: 0}}).dataset.surcharge);\n    const cost = (gatewayElement || {dataset: {cost: defaultCost}}).dataset.cost;\n\n    const {html, js} = await Templates.renderForPromise('core_payment/fee_breakdown', {fee: cost, surcharge});\n    Templates.replaceNodeContents(root.querySelector(Selectors.regions.costContainer), html, js);\n};\n\n/**\n * Process payment using the selected gateway.\n *\n * @param {string} gateway The gateway to be used for payment\n * @param {string} component Name of the component that the itemId belongs to\n * @param {string} paymentArea Name of the area in the component that the itemId belongs to\n * @param {number} itemId An internal identifier that is used by the component\n * @param {string} description Description of the payment\n * @returns {Promise<string>}\n */\nconst processPayment = async(gateway, component, paymentArea, itemId, description) => {\n    const paymentMethod = await import(`paygw_${gateway}/gateways_modal`);\n    return paymentMethod.process(component, paymentArea, itemId, description);\n};\n\n/**\n * Set up the payment actions.\n */\nexport const init = () => {\n    if (!init.initialised) {\n        // Event listeners should only be registered once.\n        init.initialised = true;\n        registerEventListeners();\n    }\n};\n\n/**\n * Whether the init function was called before.\n *\n * @static\n * @type {boolean}\n */\ninit.initialised = false;\n"],"names":["_modal_factory","_interopRequireDefault","_templates","_selectors","_modal_events","_events","_notification","_modal_gateways","_systemImportTransformerGlobalIdentifier","window","self","global","obj","__esModule","default","_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","undefined","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","_ref","_ref3","_ref4","show","_callee","rootNode","_ref2$focusOnClose","focusOnClose","modal","rootElement","gateways","_yield$Templates$rend","html","js","_args","_context","t0","ModalFactory","t1","ModalGateways","TYPE","getString","get_string","t2","Templates","render","t3","t4","title","body","getRoot","addToastRegion","on","ModalEvents","hidden","destroy","focus","e","PaymentEvents","proceed","gateway","querySelector","Selectors","processPayment","dataset","component","paymentarea","itemid","description","message","hide","Notification","addNotification","location","href","successurl","alert","addToast","preventDefault","addEventListener","target","matches","elements","updateCostRegion","cost","getAvailableGateways","renderForPromise","replaceNodeContents","regions","gatewaysContainer","selectSingleGateway","_x","root","querySelectorAll","checked","_callee2","defaultCost","gatewayElement","surcharge","_yield$Templates$rend2","_args2","_context2","parseInt","fee","costContainer","_x2","_callee3","paymentArea","itemId","paymentMethod","_context3","amd","require","concat","module","loader","process","_x3","_x4","_x5","_x6","_x7","init","initialised","document","gatewayTrigger","closest","_exports"],"mappings":"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"}