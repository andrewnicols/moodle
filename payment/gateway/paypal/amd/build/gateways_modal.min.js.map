{"version":3,"file":"gateways_modal.min.js","sources":["../src/gateways_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This module is responsible for PayPal content in the gateways modal.\n *\n * @module     paygw_paypal/gateway_modal\n * @copyright  2020 Shamim Rezaie <shamim@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as Repository from './repository';\nimport Templates from 'core/templates';\nimport Truncate from 'core/truncate';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport {get_string as getString} from 'core/str';\n\n/**\n * Creates and shows a modal that contains a placeholder.\n *\n * @returns {Promise<Modal>}\n */\nconst showModalWithPlaceholder = async() => {\n    const modal = await ModalFactory.create({\n        body: await Templates.render('paygw_paypal/paypal_button_placeholder', {})\n    });\n    modal.show();\n    return modal;\n};\n\n/**\n * Process the payment.\n *\n * @param {string} component Name of the component that the itemId belongs to\n * @param {string} paymentArea The area of the component that the itemId belongs to\n * @param {number} itemId An internal identifier that is used by the component\n * @param {string} description Description of the payment\n * @returns {Promise<string>}\n */\nexport const process = (component, paymentArea, itemId, description) => {\n    return Promise.all([\n        showModalWithPlaceholder(),\n        Repository.getConfigForJs(component, paymentArea, itemId),\n    ])\n    .then(([modal, paypalConfig]) => {\n        modal.getRoot().on(ModalEvents.hidden, () => {\n            // Destroy when hidden.\n            modal.destroy();\n        });\n\n        return Promise.all([\n            modal,\n            paypalConfig,\n            switchSdk(paypalConfig.clientid, paypalConfig.currency),\n        ]);\n    })\n    .then(([modal, paypalConfig]) => {\n        // We have to clear the body. The render method in paypal.Buttons will render everything.\n        modal.setBody('');\n\n        return new Promise(resolve => {\n            window.paypal.Buttons({\n                // Set up the transaction.\n                createOrder: function(data, actions) {\n                    return actions.order.create({\n                        purchase_units: [{ // eslint-disable-line\n                            amount: {\n                                currency_code: paypalConfig.currency_code, // eslint-disable-line\n                                value: paypalConfig.cost,\n                            },\n                            description: Truncate.truncate(description, {length: 127, stripTags: true}),\n                        }],\n                        application_context: { // eslint-disable-line\n                            shipping_preference: 'NO_SHIPPING', // eslint-disable-line\n                            brand_name: Truncate.truncate(paypalConfig.brandname, {length: 127, stripTags: true}), // eslint-disable-line\n                        },\n                    });\n                },\n                // Finalise the transaction.\n                onApprove: function(data) {\n                    modal.getRoot().on(ModalEvents.outsideClick, (e) => {\n                        // Prevent closing the modal when clicking outside of it.\n                        e.preventDefault();\n                    });\n\n                    modal.setBody(getString('authorising', 'paygw_paypal'));\n\n                    Repository.markTransactionComplete(component, paymentArea, itemId, data.orderID)\n                    .then(res => {\n                        modal.hide();\n                        return res;\n                    })\n                    .then(resolve);\n                }\n            }).render(modal.getBody()[0]);\n        });\n    })\n    .then(res => {\n        if (res.success) {\n            return Promise.resolve(res.message);\n        }\n\n        return Promise.reject(res.message);\n    });\n};\n\n/**\n * Unloads the previously loaded PayPal JavaScript SDK, and loads a new one.\n *\n * @param {string} clientId PayPal client ID\n * @param {string} currency The currency\n * @returns {Promise}\n */\nconst switchSdk = (clientId, currency) => {\n    const sdkUrl = `https://www.paypal.com/sdk/js?client-id=${clientId}&currency=${currency}`;\n\n    // Check to see if this file has already been loaded. If so just go straight to the func.\n    if (switchSdk.currentlyloaded === sdkUrl) {\n        return Promise.resolve();\n    }\n\n    // PayPal can only work with one currency at the same time. We have to unload the previously loaded script\n    // if it was loaded for a different currency. Weird way indeed, but the only way.\n    // See: https://github.com/paypal/paypal-checkout-components/issues/1180\n    if (switchSdk.currentlyloaded) {\n        const suspectedScript = document.querySelector(`script[src=\"${switchSdk.currentlyloaded}\"]`);\n        if (suspectedScript) {\n            suspectedScript.parentNode.removeChild(suspectedScript);\n        }\n    }\n\n    const script = document.createElement('script');\n\n    return new Promise(resolve => {\n        if (script.readyState) {\n            script.onreadystatechange = function() {\n                if (this.readyState == 'complete' || this.readyState == 'loaded') {\n                    this.onreadystatechange = null;\n                    resolve();\n                }\n            };\n        } else {\n            script.onload = function() {\n                resolve();\n            };\n        }\n\n        script.setAttribute('src', sdkUrl);\n        document.head.appendChild(script);\n\n        switchSdk.currentlyloaded = sdkUrl;\n    });\n};\n\n/**\n * Holds the full url of loaded PayPal JavaScript SDK.\n *\n * @static\n * @type {string}\n */\nswitchSdk.currentlyloaded = '';\n"],"names":["_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","call","next","Object","done","push","value","length","err","return","_iterableToArrayLimit","o","minLen","_arrayLikeToArray","n","prototype","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","len","arr2","_regeneratorRuntime","exports","Op","hasOwn","hasOwnProperty","defineProperty","key","desc","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","undefined","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","Repository","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","set","_interopRequireWildcard","_templates","_truncate","_modal_factory","_modal_events","_ref","showModalWithPlaceholder","_callee","modal","_context","t0","ModalFactory","Templates","render","t1","t2","body","show","args","arguments","apply","_exports","process","component","paymentArea","itemId","description","all","getConfigForJs","_ref2","_ref3","paypalConfig","getRoot","on","ModalEvents","hidden","destroy","switchSdk","clientid","currency","_ref4","_ref5","setBody","window","paypal","Buttons","createOrder","data","actions","order","purchase_units","amount","currency_code","cost","Truncate","truncate","stripTags","application_context","shipping_preference","brand_name","brandname","onApprove","outsideClick","e","preventDefault","getString","markTransactionComplete","orderID","res","hide","getBody","success","message","clientId","sdkUrl","concat","currentlyloaded","suspectedScript","document","querySelector","parentNode","removeChild","script","createElement","readyState","onreadystatechange","onload","setAttribute","head","appendChild"],"mappings":"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"}